var server_url="undefined"!=typeof interactions_url?interactions_url:"https://usi-saas.vnexpress.net",js_url_vne=void 0!==js_url_vne?js_url_vne:"https://s1.vnecdn.net/vnexpress/restruct/j/v2874",css_url_vne=void 0!==css_url_vne?css_url_vne:"https://s1.vnecdn.net/vnexpress/restruct/c/v1030",img_url_vne=void 0!==img_url_vne?img_url_vne:"https://s1.vnecdn.net/vnexpress/restruct/i/v529",DELAY_TIME=3e3;(function(window,document){"use strict";window.VNE=window.VNE||{};var loadIconSvg=function(){var e=css_url_vne+"/v2/wcomment/pc/vne/images/graphics/symbol-defs.svg";if(!document.createElementNS||!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect)return!0;var t,n,o="localStorage"in window&&null!==window.localStorage,i=function(){document.body.insertAdjacentHTML("afterbegin",n)},a=function(){document.body?i():document.addEventListener("DOMContentLoaded",i),$("svg").each(function(){$(this).find("title").remove()})};if(o&&1==localStorage.getItem("cmtSVGrev")&&(n=localStorage.getItem("cmtSVGdata")))return a(),!0;try{(t=new XMLHttpRequest).open("GET",e,!0),t.onload=function(){t.status>=200&&t.status<400&&(n=t.responseText,a(),o&&(localStorage.setItem("cmtSVGdata",n),localStorage.setItem("cmtSVGrev",1)))},t.send()}catch(e){}};window.VNE.Comment={};var options={offset:0,limit:15,frommobile:0,sort_by:"like",is_onload:1},root,totalEl,listCommentEl,listPinComment,listExpertComment,wrapEditorComment,currentPage,isShowMore=0,useReply=0,_isListener=0,_member={email:"",fullname:"",share:1,type:""},_debug=!1,_showTip=!0,_scrollToTop=null,_numberCommentToShow=6,_objComments={},key_user_react="usi_react",tracking_scroll=0,anonymous_selected=0,check_myvne_interval,is_live=0,is_live_300=0,class_site_detect="",site_id_cmt=void 0!==options.siteid&&options.siteid>0?options.siteid:0;switch(0==site_id_cmt&&(site_id_cmt="undefined"!=typeof SITE_ID?SITE_ID:0),site_id_cmt){case 1002835:class_site_detect="box_comment_ngoisao";break;case 1004058:class_site_detect="box_comment_startup";break;default:class_site_detect=""}$('meta[name="its_type"]').length&&"live"==$('meta[name="its_type"]').attr("content")&&($(".detail-live .sidebar-2").length&&$(".detail-live .sidebar-2 .box_comment_vne").length&&$(".detail-live .sidebar-2").width()<400&&(class_site_detect+=" box_comment_pin",is_live_300=1),is_live=1);try{void 0===$.magnificPopup&&($('script[src*="jquery.magnific-popup"]').remove(),CmtWidget.importScript(js_url_vne+"/v3/"+(location.hostname.indexOf("demo.vnexpress.net")>-1?"pc":"production")+"/libs/jquery.magnific-popup.min.js"))}catch(e){}loadIconSvg();var setOption=function(e){if(isShowMore=0,options.is_onload=1,e=e||{},(options=$.extend(options,e)).cookie_aid=cookies("fosp_aid"),options.cookie_aid||(options.cookie_aid=e.device_id),options.usertype=4,$('div[data-component-type="comment_library"]').length?root=$('div[data-component-type="comment_library"]'):$(`[data-component-widget-article="${options.objectid}"]`).length?(root=$(`[data-component-widget-article="${options.objectid}"]`)).addClass("widget_comment_article"):root=$("#box_comment_vne"),!parseDomBoxComment(options))return!1;Emoticons.addSmilesBox(),listCommentEl=root.find("#list_comment"),wrapEditorComment=root.find("#wrap_editor_comment"),listPinComment=root.find("#list_pin_comment"),listExpertComment=root.find("#list_expert_comment");var t=root.find("div.loading");t.find("img.img_comment_loading").length||t.css({"text-align":"center","padding-top":"15px",display:"none",width:"100%",float:"left"}).html('<img class="img_comment_loading" src="'+css_url_vne+'/images/graphics/loading1.gif" style="width:25px;" title="Đang tải dữ liệu" alt="Đang tải dữ liệu">'),currentPage=0,"undefined"==typeof device_env&&(device_env=4),options.limit=options.limit?parseInt(options.limit):25;var n=getParameter("commentid");if(void 0!==n&&0<n&&(options.commentid=n),"object"==typeof myvne_users&&myvne_users.getProfileData(function(e){setUiMyVNE(e)}),root.find('button[type="button"]').on("click",function(e){e.stopPropagation(),useReply="comment_reply_button"==$(this).attr("id")?1:0,validateComment($(this))}),initEvent(),_isListener)return options.offset=0,root.children().children(".view_more_coment").hide(),root.find("#cmt-paginator").find("a").remove(),listCommentEl.find(".comment_item").remove(),this;check_myvne_interval=setInterval(function(){"object"==typeof myvne_users&&(clearInterval(check_myvne_interval),myvne_users.setCallback("login",function(e){if(setUiMyVNE(e),"undefined"!=typeof sessionStorage&&sessionStorage.view_comment);else{var t=getContentComment(),n=useReply?$("#comment_reply_form").find(".txt_comment"):$("#comment_post_form").find(".txt_comment");t.content.length&&"Chia sẻ ý kiến của bạn"!=t.content&&validate_Link(n),n.focusin()}}),myvne_users.setCallback("logout",function(e){setUiMyVNE(e);var t=getContentComment(),n=useReply?$("#comment_reply_form").find(".txt_comment"):$("#comment_post_form").find(".txt_comment");t.content.length&&"Chia sẻ ý kiến của bạn"!=t.content&&(validate_Link(n),validate_Emoji(n)),n.focusin()}),myvne_users.setCallback("anonymous",function(e){anonymous_selected=1,setUiMyVNE();var t=getContentComment(),n=useReply?$("#comment_reply_form").find(".txt_comment"):$("#comment_post_form").find(".txt_comment");t.content.length&&"Chia sẻ ý kiến của bạn"!=t.content&&(validate_Link(n),validate_Emoji(n)),n.focusin()}),myvne_users.getProfileData(function(e){setUiMyVNE(e)}))},1e3),setTimeout(function(){check_myvne_interval&&clearInterval(check_myvne_interval)},5e3),_scrollToTop="function"==typeof options.scrollFunc?options.scrollFunc:function(e){var t=$("#box_comment_vne").offset().top-50;if("function"==typeof e){var n=function(){(window.scrollTop||window.pageYOffset)<=t+10&&(window.removeEventListener("scroll",n),e())};window.addEventListener("scroll",n),n()}window.scrollTo({top:t,behavior:"smooth"})},"#box_comment"!=window.location.hash&&"#box_comment_vne"!=window.location.hash||(setTimeout(_scrollToTop,100),setTimeout(_scrollToTop,1e3),setTimeout(_scrollToTop,2e3));var o=function(){try{var e=$("#list_comment:visible").length>0?"#box_comment_vne":".txt_comment";isInViewport(document.querySelectorAll(e)[0])&&(tracking_scroll=1,dataLayer.push({event:"commentEvent",method:"",comment_action:"Scroll to comments"}),listCommentEl.find("> .comment_item").length&&loadCaptchaV3(options.siteid))}catch(e){tracking_scroll=1}};return setTimeout(function(){o()},1e3),$(window).on("resize scroll",function(){tracking_scroll||o()}),$(document).on("click",'a[href="#box_comment_vne"]',function(e){e.preventDefault();try{dataLayer.push({event:"commentEvent",comment_action:"Go to comment",user_id:void 0!==myvne_users.profile.user_id?myvne_users.profile.user_id:cookies("fosp_aid")})}catch(e){}return _scrollToTop(),!1}),$(document).on("click",".mfp-wrap, .box_comment_vne .block_relative, #comment_post_form",function(e){e.stopPropagation(),e.preventDefault()}),_isListener=1,window.addEventListener("beforeunload",function(e){var t=getContentComment();if(t.content.length&&-1===["Ý kiến của bạn","Chia sẻ ý kiến của bạn"].indexOf(t.content))return e.preventDefault(),e.returnValue="Nội dung đang nhập sẽ bị mất"}),this},parseDomBoxComment=function(e){if(root.length){var t="active",n="";void 0!==e.tab_active&&"newest"==e.tab_active&&(t="",n="active",sortedBy("time"));var o="Ý kiến";"undefined"!=typeof IS_EVISUAL&&IS_EVISUAL&&(o="Comment");let i=`\n                <div class="box_comment_vne width_common animated animatedFadeInUp fadeInUp gaElementVisibility" data-event-category="Article Link Display" data-event-action="View Comment" data-event-label="${formatUtmSourceText(getFolderSetOn())}" style="display:none;">\n                    <div class="ykien_vne width_common">\n                        <div class="left"><h3 style="display:inline-block;font-weight:bold;" rel="time">${o}</h3> (<label id="total_comment">0</label>)</div>\n                    </div>\n                    <div class="input_comment width_common">\n                        <form id="comment_post_form">\n                            <div class="box-area-input width_common">\n                                <textarea id="txtComment" class="txt_comment block_input" placeholder="Chia sẻ ý kiến của bạn"></textarea>\n                                \n                            </div>\n                            <span class="error_lk error_txt_cmt" style="display: none;">Bạn chưa nhập nội dung bình luận.</span>\n                            <div class="box_emoji" style="display:none;"></div>\n                            <div class="width_common block_relative" style="display:none;">\n                                <div class="left block_not_login block_anonymous"></div>\n                                <div class="right block_btn_send">\n                                    <button class="btn_cancel_comment btn_vne" style="display:none;">Hủy</button>\n                                    <button type="button" value="Gửi" class="btn_send_comment btn_vne" id="comment_post_button">Gửi</button>\n                                </div>\n                                <div class="like_google" style="display:none;">\n                                    <div class="google_name">\n                                        <img id="open_id_status" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" width="24px" height="30pxalt="vnexpress" class="google_active" />\n                                    </div>\n                                    <div class="block_action_google" style="display:none;">\n                                        <ul>\n                                            <li><a id="open_id_share" href="javascript:;" title="Tắt chia sẻ">Tắt chia sẻ</a></li>\n                                            <li><a id="open_id_sigout" href="javascript:;" title="Đăng xuất">Đăng xuất</a></li>\n                                        </ul>\n                                    </div>\n                                </div>\n                            </div>\n                        </form>\n                        <div id="comment_reply_wrapper" class="input_comment reply_input_comment width_common" style="display: none;">\n                            <form id="comment_reply_form">\n                                <div class="box-area-input width_common">\n                                    <textarea id="txtComments" class="txt_comment block_input" placeholder="Chia sẻ ý kiến của bạn"></textarea>\n                                    \n                                </div>\n                                <span class="error_lk error_txt_cmt" style="display: none;">Bạn chưa nhập nội dung bình luận.</span>\n                                <div class="box_emoji" style="display:none;"></div>\n                                <div class="width_common block_relative" style="display:none;">\n                                    <div class="left block_not_login block_anonymous"></div>\n                                    <div class="right">\n                                        <button class="btn_cancel_comment btn_vne" style="display:none;">Hủy</button>\n                                        <button type="button" value="Gửi" class="btn_send_comment btn_vne" id="comment_reply_button">Gửi</button>\n                                    </div>\n                                    <div class="like_google" style="display:none;">\n                                        <div class="google_name">\n                                            <img id="open_id_status" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" width="24px" height="30pxalt="vnexpress" class="google_active" />\n                                        </div>\n                                        <div class="block_action_google" style="display:none;">\n                                            <ul>\n                                                <li><a id="open_id_share" href="javascript:;" title="Tắt chia sẻ">Tắt chia sẻ</a></li>\n                                                <li><a id="open_id_sigout" href="javascript:;" title="Đăng xuất">Đăng xuất</a></li>\n                                            </ul>\n                                        </div>\n                                    </div>\n                                </div>\n                            </form>\n                        </div>\n                    </div>\n                    <div class="width_common comment--editor mb0" id="wrap_editor_comment" style="display: none;">\n                        <div class="width_common wrap_expert_comment" style="display: none;">\n                            <div class="filter_coment width_common mt20"><a class="active" href="javascript:;">Chuyên gia tư vấn</a></div>\n                            <div class="width_common" id="list_expert_comment"></div>\n                        </div>\n                        <div class="width_common wrap_pin_comment" style="display: none;">\n                            <div class="filter_coment width_common" style="margin-top: 6px;"></div>\n                            <div class="width_common" id="list_pin_comment"></div>\n                        </div>\n                    </div>\n                    <div class="filter_coment width_common mt20">\n                        <a href="javascript:;" class="${t}" rel="like">Quan tâm nhất</a>\n                        <a href="javascript:;" class="${n}" rel="time">Mới nhất</a>\n                    </div>\n                    <div class="loading"></div>\n                    <div class="view_all_reply_loading"></div>\n                    <div class="width_common" id="box_comment">\n                        <div class="main_show_comment width_common mb10" id="list_comment"></div>\n                    </div>\n                    <div id="cmt-paginator" class="width_common mt20" style="display: none;">\n                        <p id="pagination" class="pagination mb10"></p>\n                    </div>\n                </div>\n            `;if(root.hasClass("box_comment_vne")&&root.removeClass("box_comment_vne"),root.addClass(class_site_detect),root.html(i),is_live_300&&(root.find(".ykien_vne").remove(),$("#comment_post_form").parent().appendTo(".box_comment_vne")),1002764==site_id_cmt&&(root.find('.filter_coment a[rel="time"]').text("Newest"),root.find('.filter_coment a[rel="like"]').text("Most liked")),$(".sidebar-1.pin-comment")[0]&&$(".sidebar-1.pin-comment").css("z-index",1),root.hasClass("widget_comment_article")){root.find(".ykien_vne,.filter_coment").hide(),root.find(".btn_cancel_comment").show();const e=root.find("#comment_post_form").closest("div.input_comment");root.find("#box_comment").after(e)}return!0}return!1},sortedBy=function(e){return"time"!=e&&"like"!=e&&"vne"!=e||(options.sort_by=e,options.offset=0,isShowMore=0),!1},strip=function(e){var t=document.createElement("DIV");return t.innerHTML=e,t.textContent||t.innerText||""},showAlertBox=function(e,t){if(t=t||"Thông báo",void 0===$.magnificPopup||"object"!=typeof $.magnificPopup)alert(strip(e));else{var n='<div class="white-popup width-medium"><div class="inner-popup"><div class="title-popup">'+t+'</div><div class="content-popup">'+e+"</div></div></div>";$.magnificPopup.open({items:{src:n},mainClass:"mfp-with-zoom lightbox_for_comment",type:"inline",midClick:!0,fixedContentPos:!1,fixedBgPos:!0,overflowY:"auto",closeBtnInside:!0,preloader:!1,removalDelay:300})}},hideAlertBox=function(){"object"==typeof $.magnificPopup&&$.magnificPopup.close()},getParameter=function(e){for(var t=window.location.search.substring(1).split("&"),n=0;n<t.length;n++){var o=t[n].split("=");if(o[0]==e)return o[1]}},showReportBadForm=function(e){if(0==cookies("report_bad_"+$(e).attr("rel")))return showAlertBox("Bạn đã sử dụng chức năng này. Bạn phải đợi 24h nữa mới được thao tác tiếp"),!1;var t='<select class="txt_select_lydo input_form" id="reason">';$.each([{value:0,text:"Chọn"},{value:1,text:"Xúc phạm, gây hại người khác"},{value:2,text:"Lạc đề"},{value:3,text:"Vi phạm pháp luật"},{value:4,text:"Vi phạm đạo đức, thuần phong mỹ tục"},{value:5,text:"Tố cáo sai sự thật"},{value:6,text:"Vi phạm bản quyền"},{value:7,text:"Để lộ thông tin cá nhân"},{value:8,text:"Spam, rác"},{value:9,text:"Lý do khác"}],function(e,n){t+='<option value="'+n.value+'">'+n.text+"</option>"});var n='<div class="white-popup width-medium lightbox_vipham '+class_site_detect+' clearfix"><div class="inner-popup"><div class="title-popup">Báo vi phạm</div><div class="content-popup"><ul class="form_element"><li class="width_common"><label class="label_form">Chọn lý do Vi phạm</label>'+(t+="</select>")+'<div class="width_common txt_error login-desc"></div></li><li class="width_common"><label class="label_form">Ý kiến:</label><textarea name="message" class="input_form input_area" onfocus="if (this.value == \'Nội dung phản hồi khác\') {this.value = \'\';}" onblur="if (this.value == \'\') {this.value = \'Nội dung phản hồi khác\';}" value="Nội dung phản hồi khác">Nội dung phản hồi khác</textarea></li><li class="width_common"><label class="label_form">Địa chỉ email của bạn:</label><input name="email" class="input_form" type="email" onfocus="if (this.value == \'Email\') {this.value = \'\';}" onblur="if (this.value == \'\') {this.value = \'Email\';}" value="Email"><div class="width_common txt_error login-desc"></div></li><li class="width_common"><label class="label_form">Chặn người dùng</label><select class="input_form" id="block_user"><option value="0">Không chặn</option><option value="1">Chặn</option></select><div class="width_common txt_error login-desc"></div></li><li class="width_common"><label class="label_form">Mã xác nhận:</label><input name="txtCaptcha" maxlength="4" class="input_30 left input_form" type="text"><div class="input_capcha capcha"><img src=""></div><a class="btn_refrest refresh_captcha" href="javascript:;" title="Tạo mã khác"><img src="'+img_url_vne+'/refesh.gif"></a><div class="width_common txt_error login-desc"></div></li><li class="width_common"><button type="button" id="btt_send_report_bad" class="btn_vne btn_sk btn_vne_bold" rel="'+$(e).attr("rel")+'" uid-comment="'+$(e).attr("uid-comment")+'">Gửi</button></li></ul></div></div><button title="Close (Esc)" type="button" class="mfp-close">×</button></div>';getCaptchaCode(),$.magnificPopup.open({items:{src:n},type:"inline",midClick:!0,mainClass:"mfp-with-zoom lightbox_for_comment",fixedContentPos:!1,fixedBgPos:!0,overflowY:"auto",closeBtnInside:!0,preloader:!1,removalDelay:300}),$(".mfp-content .txt_select_lydo").css("visibility","visible"),$(".mfp-content .refresh_captcha").on("click",function(e){e.preventDefault(),getCaptchaCode()}),$("#btt_send_report_bad").on("click",function(e){e.preventDefault(),addReportBad()})},checIE8=function(){var e=navigator.userAgent.toLowerCase();return-1!=e.indexOf("msie")&&8==parseInt(e.split("msie")[1])},getCaptchaCode=function(){$.getJSON(server_url+"/captcha/show?callback=?",{deviceenv:device_env,object:"reportbad_"+cookies("fosp_aid")},function(e){$(".mfp-content .input_capcha").html(e.html),checIE8()&&$(".mfp-content .input_capcha img").css("max-width","none")})},trim=function(e){return void 0===e||""==e?"":e.replace(/^\s+|\s+$/g,"")},validateEmail=function(e){if(""===(e=trim(e)))return!1;return/^[a-zA-Z0-9\.\-]+@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)},getScript=function(e,t,n){(t=t||{}).data=t.data||{},e=server_url+"/"+e,$.getJSON(e,t,function(e){"function"==typeof n&&n(e)})},getScriptExt=function(e,t,n){(t=t||{}).data=t.data||{},$.ajax({url:e,data:t,dataType:"jsonp",jsonpCallback:"displayUserMyVnE",cache:!0,success:function(e){"function"==typeof n&&n(e)}})},getCaptchaKey=function(e){var t="6Let__wkAAAAAHpwW5ndPvqbcGYd0KNP8r1AV8xj";if(1e6===+e)t="6LcKG6sUAAAAAOZK1O-gJLkp6iAdcACrkUrDD86I";return t},loadCaptchaV3=function(e,t){var n,o,i,a=getCaptchaKey(e);if("undefined"==typeof grecaptcha||document.querySelector(`script[src*="${a}"]`)||(grecaptcha={}),"undefined"!=typeof grecaptcha&&grecaptcha.execute&&"function"==typeof t)grecaptcha.execute(a,{action:"like_cmt_pc"}).then(function(e){t(e),$("#_cmt_token").val(e)});else try{n="https://www.google.com/recaptcha/api.js?render="+a,o=function(){grecaptcha.ready(function(){$("body").append("<style>.grecaptcha-badge{display: none !important;}</style>"),0==$("input#_cmt_token").length&&$("<input>").attr({type:"hidden",id:"_cmt_token",name:"_cmt_token"}).appendTo("body"),"function"==typeof t&&grecaptcha.execute(a,{action:"like_cmt_pc"}).then(function(e){t(e),$("#_cmt_token").val(e)})})},(i=document.createElement("script")).async="async",i.src=n,o&&(i.onload=o),document.getElementsByTagName("head")[0].appendChild(i)}catch(e){console.log("loadCaptchaV3",e)}},cookies=function(e,t,n){if(arguments.length>1&&"[object Object]"!==String(t)){if(n="object"==typeof n?n:{},null==t&&(n.expires=-1),"number"==typeof n.expires){var o=864e5*parseInt(n.expires),i=(n.expires=new Date).getTime();n.expires.setTime(i+o)}return t=String(t),document.cookie=[encodeURIComponent(e),"=",n.raw?t:encodeURIComponent(t),n.expires?"; expires="+n.expires.toUTCString():"",n.path?"; path="+n.path:"",n.domain?"; domain="+n.domain:"",n.secure?"; secure":"",n.samesite?"; samesite="+n.samesite:""].join("")}var a,s=(n=t||{}).raw?function(e){return e}:decodeURIComponent;return(a=new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)").exec(document.cookie))?s(a[1]):null},format_number=function(e,t,n,o){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var i=isFinite(+e)?+e:0,a=isFinite(+t)?Math.abs(t):0,s=void 0===o?".":o,r=void 0===n?",":n,c="";return c=(a?function(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}(i,a):""+Math.round(i)).split("."),c[0].length>3&&(c[0]=c[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,s)),(c[1]||"").length<a&&(c[1]=c[1]||"",c[1]+=new Array(a-c[1].length+1).join("0")),c.join(r)},setTotalComment=function(e,t){totalEl=root.find("#total_comment"),e&&(totalEl.html(format_number(e)),$(".video_yk").length&&$(".video_yk").find("#total_comment").html(format_number(e)),root.find(".ykien_vne").show(),root.find("div.title_show").show()),e&&is_live_300&&$('.detail-live .header-tab a[data-id="box_comment"]').text("Ý kiến ("+e+")")},makePaginator=function(e,t){makePaginatorMobile(e,t)},makePaginatorMobile=function(e,t){if(listCommentEl.find(".view_more_coment").remove(),e>options.offset+options.limit){t=void 0!==t&&1==t?'style= "display: none"':"";listCommentEl.append('<div class="view_more_coment width_common mb10" '+t+'><a id="show_more_coment" href="javascript:;" class="txt_666" title="Xem thêm ý kiến">Xem thêm ý kiến</a></div>'),getParameter("commentid")>0&&1==options.is_onload&&(root.children().children(".view_more_coment").show(),root.find(">> .view_more_coment a").click())}},makePaginatorWeb=function(e){if(root.find("#cmt-paginator").hide(),!(e<=options.limit)){var t,n=Math.ceil(e/options.limit),o=options.offset/options.limit+1,i=1;t=(o=Math.round(o))+2>n?n:o+2,t=(1===o||2===o)&&n>4?5:n<=4||o+2>=n?n:o+2,(i=o-2>0?o-2:1)<0&&(t=5,i=1),t>n&&(t=n,i=o-4),n-o<2&&(i=t-4>0?t-4:1);for(var a="",s=i;s<=t;s++)a+=o==s?'<a class="page-s active disable" href="javascript:;" rel="'+s+'">'+s+"</a>":'<a class="page-s" href="javascript:;" rel="'+s+'">'+s+"</a>";var r;r=`<div id="pagination" class="paging right flexbox">\n                            <span class="selected-page">Trang</span>\n                            <div class="button-page flexbox">\n                                <a href="javascript:void(0)" class="btn-page prev-page ${(o>1&&n>0?"":"disable")+'" rel="'+(o-1)}"></a>  \n                                <input id="inputPage" type="text" class="btn-page type_page paging_folder" value="${o}" max-page="${n}" style="width: 20px;">\n                                <a href="/thoi-su-p2" class="btn-page next-page ${(o<n?"":"disable")+'" rel="'+(o+1)}"></a>\n                            </div>\n                        </div>`;var c=$("#cmt-paginator");c.empty().append(r),c.find("#pagination a").on("click",function(e){if(e.preventDefault(),$(this).hasClass("disable"))return!1;options.is_onload=0;var t=parseInt($(this).attr("rel"));options.offset=options.limit*(t-1),root.find("#cmt-paginator").hide(),root.find("#comment_reply_wrapper:last").hide().appendTo(".box_comment_vne"),_getMoreComment(options)}),c.find("#inputPage").on("keypress",function(e){if(13==e.which){var t=Math.floor(Number($(this).val()));return t>0&&t<=parseInt($(this).attr("max-page"))?(options.is_onload=0,options.offset=options.limit*(t-1),root.find("#cmt-paginator").hide(),root.find("#comment_reply_wrapper:last").hide().appendTo(".box_comment_vne"),void _getMoreComment(options)):void 0}}),c.find(".selected-page").on("click",function(e){c.find(".box-open-select").toggle(function(){$(this).height()})}),isShowMore&&root.find("#cmt-paginator").show(),getParameter("commentid")>0&&1==options.is_onload&&root.find("#cmt-paginator").show()}},_getMoreComment=function(e,t){if(t.hasClass("loading_comment"))return;isShowMore=1,t.addClass("loading_comment"),t.text("Đang tải...");let n=Object.assign({},e);0==n.offset?n.limit=_numberCommentToShow:n.limit=e.limit,$.ajax({data:n,url:server_url+"/index/get",dataType:"json",success:function(n,o,i){t.removeClass("loading_comment"),t.text("Xem thêm ý kiến"),n.error||n.data.total&&("expert"===e.sort_by?displayExpertComment(n.data.items,n.data.total,e.template_type,!1):(setTotalComment(n.data.totalitem,n.data.total),displayComment(n.data.items,n.data.total,e.template_type,!0,n.data.total_pin),"undefined"!=typeof is_run_version_B&&1==is_run_version_B&&"undefined"!=typeof VideoVNE&&"function"==typeof VideoVNE.balanceColAB&&VideoVNE.balanceColAB()))},timeout:3e4,error:function(e,n,o){console.log("_getMoreComment error",n),t.remove()}})},validateComment=function(e){var t="comment_reply_button"===e.attr("id")?1:2,n=e.parent().parent().parent(),o=n.find(".txt_comment"),i=getContentComment(),a=trim(i.content),s=!0;if(0==$("#btnReply").length?n.append('<input type="hidden" id="btnReply" value='+t+">"):$("#btnReply").val(t),"Chia sẻ ý kiến của bạn"==a||""==a?("object"==typeof myvne_users&&void 0!==myvne_users.profile.user_id||anonymous_selected?(o.focus(),o.parents(".box-area-input").addClass("input_error"),o.parents("form").find(".error_txt_cmt").show()):openPopupMyVnE(),s=!1):(o.parents(".box-area-input").removeClass("input_error"),o.parents("form").find(".error_txt_cmt").css("display","none")),anonymous_selected&&(validate_Cmt_Anonymous(e)||(s=!1,o.parents(".box-area-input").hasClass("input_error")&&o.focus())),validate_Emoji(o)||(s=!1),validate_Link(o)||(s=!1),a.length>1500&&(showAlertBox("Số lượng ký tự tối đa 1500 ký tự"),s=!1),0==s)return!1;if("object"!=typeof myvne_users||"function"!=typeof myvne_users.authentication||anonymous_selected)_member.fullname&&_member.email&&_member.type?addComment(a,i.parent_id,i.reply_to):addComment_Anonymous(e);else{if("object"!=typeof myvne_users||void 0===myvne_users.profile.user_id)return void openPopupMyVnE();var r=myvne_users.profile;_member.fullname=r.user_fullname_original,_member.email=r.user_email,_member.userid=r.user_id,_member.user_session=r.user_session,_member.usertype=r.user_login_type,""!=r.user_fullname&&r.user_fullname?addComment(a,i.parent_id,i.reply_to):addComment_UpdateName(e)}return!1},validate_Emoji=function(e){var t=!1;if("object"!=typeof myvne_users||"object"!=typeof myvne_users.profile||void 0===myvne_users.profile.user_id){var n=getContentComment();Emoticons.checkHadEmoji(n.content)?(e.parents(".input_comment").find(".block_anonymous .not_login").hide(),e.parents(".input_comment").find(".block_anonymous .err_emj").length<=0?(e.parents(".input_comment").find(".block_anonymous").append('<p class="error_lk err_emj">Cần đăng nhập để gửi biểu tượng cảm xúc. Hãy <a href="javascript:;" id="login_cmt" class="login_cmt">đăng nhập</a> hoặc <a href="javascript:;" class="register_cmt">tạo tài khoản</a></p>').show(),initEventLogin()):e.parents(".input_comment").find(".block_anonymous .err_emj").show()):(e.parents(".input_comment").find(".block_anonymous .err_emj").hide(),$(".err_link:visible").length<=0&&$(".err_emj:visible").length<=0&&e.parents(".input_comment").find(".block_anonymous .not_login").show(),t=!0)}else t=!0;return t},validate_Link=function(e){var t=!1,n=getContentComment();return checkHadDomainLink(n.content)?(e.parents(".input_comment").find(".block_anonymous .not_login").css("display","none"),e.parents(".input_comment").find(".block_anonymous .err_link").length<=0?void 0===myvne_users.profile.user_id?(e.parents(".input_comment").find(".block_anonymous").append('<p class="error_lk err_link">Cần đăng nhập để gửi liên kết. Hãy <a href="javascript:;" id="login_cmt" class="login_cmt">đăng nhập</a> hoặc <a href="javascript:;" class="register_cmt">tạo tài khoản</a></p>').css("display","block"),initEventLogin()):(e.parents(".input_comment").find(".like_google").css("display","none"),e.parents(".input_comment").find(".block_anonymous").append('<p class="error_lk err_link">Chỉ có thể gửi liên kết từ <a href="https://vnexpress.net" target="_blank">VnExpress.net</a> và <a href="https://ngoisao.vnexpress.net" target="_blank">ngoisao.vnexpress.net</a></p>').css("display","block")):e.parents(".input_comment").find(".like_google").css("display","none"),e.parents(".input_comment").find(".block_anonymous .err_link").css("display","block")):(e.parents(".input_comment").find(".block_anonymous .err_link").css("display","none"),$(".err_link:visible").length<=0&&$(".err_emj:visible").length<=0&&(e.parents(".input_comment").find(".block_anonymous .not_login").css("display","block"),e.parents(".input_comment").find(".like_google").css("display","block")),t=!0),t},validate_Cmt_Anonymous=function(e){var t=e.parents(".block_relative").find(".block_anonymous"),n=t.find(".txt_email"),o=t.find(".txt_fullname"),i=trim(n.val()),a=trim(o.val()),s=!1;return""==a?(t.find("#error_fullname").html("Hãy nhập họ và tên").show(),o.addClass("input_error"),o.focus()):(t.find("#error_fullname").css("display","none"),o.removeClass("input_error")),""==i?(t.find("#error_email").html("Hãy nhập email").show(),n.addClass("input_error"),n.focus()):""==i||validateEmail(i)?(t.find("#error_email").css("display","none"),n.removeClass("input_error")):(t.find("#error_email").html("Email bạn nhập không hợp lệ").show(),n.addClass("input_error"),n.focus()),""!=a&&""!=i&&validateEmail(i)&&(s=!0,t.find(".error_lk").css("display","none"),t.find("input").removeClass("input_error")),s},addComment=function(e,t,n){var o=root.find(".btn_send_comment"),i=$.extend({},options);i.content=e,"Họ tên (Hiển thị trên trang)"!=_member.fullname&&null!=_member.fullname||(_member.fullname=""),""==_member.fullname&&(_member.fullname=_member.email.replace(/@.*/,"")),void 0!==_member.un?i.un=_member.un:i.un=0,i.fullname=_member.fullname,i.email=_member.email,void 0!==_member.userid&&void 0!==_member.usertype&&(i.userid=_member.userid,i.usertype=_member.usertype),void 0!==_member.user_session&&(i.user_session=_member.user_session),i.parentid=t?parseInt(t):0,i.frommobile=1==device_env?1:0,n&&(i.reply_to=parseInt(n)),_member.share&&"facebook"==_member.type&&(i.shareurl=window.location.href.split("?")[0],i.share=1),o.text("Đang gửi..."),getAuthentication(function(e){i.t=e.t,i._csrf=e._t;var n=String(i.content)+String(i.objectid)+String(i.objecttype)+String(i.t)+String(i._csrf);i._sign=md5(n),$.ajax({url:server_url+"/post/cmt/add",type:"POST",dataType:"json",data:i,xhrFields:{withCredentials:!0},success:function(e){if(o.text("Gửi"),e.error)return 102==e.error?("string"!=typeof e.errorDescription?(showAlertBox("Bạn không thể gửi bình luận liên tục. Xin hãy đợi "+e.errorDescription+" giây nữa."),setTimeout(function(){hideAlertBox()},DELAY_TIME)):(showAlertBox("Bạn không được bình luận liên tục."),setTimeout(function(){hideAlertBox()},DELAY_TIME)),!1):(showAlertBox(e.errorDescription),!1);try{(egg=window._logEgg||[]).push({action:"comment"})}catch(e){}try{parseInt(t)>0?dataLayer.push({event:"commentEvent",method:"",comment_action:"Reply comment",user_id:void 0!==myvne_users.profile.user_id?myvne_users.profile.user_id:cookies("fosp_aid")}):dataLayer.push({event:"commentEvent",method:"",comment_action:"Submit comment",user_id:void 0!==myvne_users.profile.user_id?myvne_users.profile.user_id:cookies("fosp_aid")}),trackingADP(i)}catch(e){}try{"undefined"!=typeof vneNotify&&"undefined"!=vneNotify.setLiveComment&&vneNotify.setLiveComment()}catch(e){console.log("webpush error",e)}return $(".txt_comment").removeAttr("style"),i.parentid>0&&root.find("#comment_reply_wrapper:last").hide(),(useReply?$("#comment_reply_form").find(".txt_comment"):$("#comment_post_form").find(".txt_comment")).val(""),root.find("input.txt_comment").val(""),anonymous_selected?unSetAnonymous():(showAlertBox('<p style="text-align: center; margin:0">Bình luận đang được xét duyệt.</p> <p style="text-align: center;margin: 10px 0 0 0;color: #aaa;">Tự động đóng sau 3s</p>',"Gửi bình luận thành công"),setTimeout(function(){hideAlertBox()},DELAY_TIME)),!0},timeout:5e3,error:function(e,t,n){o.text("Gửi"),console.log("add comment error",e,t,n)}})})},addComment_Anonymous=function(e){var t=e.parents(".block_relative").find(".block_anonymous"),n=t.find(".txt_email"),o=t.find(".txt_fullname"),i=trim(n.val()),a=trim(o.val());_member.email=i,_member.fullname=a;var s=getContentComment();addComment(s.content,s.parent_id,s.reply_to)},openPopupMyVnE=(e="comment",t=1)=>{try{const n={r_siteid:parseInt($('[name="tt_site_id"]').attr("content")),r_folderid:parseInt($('[name="tt_category_id"]').attr("content")),r_action:e};myvne_users.authentication(function(n){"view_comment"===e&&("undefined"!=typeof sessionStorage&&sessionStorage.removeItem("view_comment"),1===t&&setTimeout(()=>{const e=document.querySelector("#show_more_coment");e&&e.click()},700))},"",n),"view_comment"===e&&("undefined"!=typeof sessionStorage&&sessionStorage.setItem("view_comment",t),window.close_popup_login_callback=()=>{let e=location.hostname.indexOf("video.vnexpress.net")>-1?1e3:500;setTimeout(()=>{"undefined"!=typeof sessionStorage&&sessionStorage.removeItem("view_comment")},e)})}catch(e){myvne_users._html_popup_login()}},showMessageBox_MyVnE=function(e){if(anonymous_selected){invite_MyVnE(e);e.email,0}},invite_MyVnE=function(e){""!=e.email&&(myvne_users._html_popup_invite("comment",e.email,e.fullname),myvne_users.setCallback("login",function(t){t.user_fullname=e.fullname,setUiMyVNE(t)}))},addComment_UpdateName=function(e){var t=e.parents(".block_relative").find(".block_anonymous"),n=t.find(".txt_fullname"),o=trim(n.val()),i=!1;if(""==o?t.find("#error_fullname").html("Hãy nhập Họ và tên").show():(i=!0,t.find(".error_lk").hide()),!i)return!1;_member.fullname=o,_member.un=1;var a=getContentComment();addComment(a.content,a.parent_id,a.reply_to);try{myvne_users.profile.user_fullname=o,setUiMyVNE(myvne_users.profile)}catch(e){}},addReportBad=function(){var e=$(".lightbox_vipham"),t=e.find("#reason"),n=t.parent().find(".login-desc"),o=parseInt(t.val()),i=e.find("#block_user").val(),a=+e.find("#btt_send_report_bad").attr("uid-comment"),s=window.location.href;if(s.indexOf("usi-saas.vnexpress.net")>-1&&(s="https://vnexpress.net/bai-chi-tiet-"+options.objectid+".html"),0==o)return n.html("Chọn lý do vi phạm"),t.focus(),!1;n.html("");var r=e.find('input[name="email"]'),c=r.val();"Email"==c&&(c="");var m=r.parent().find(".login-desc");if(!c)return m.html("Thiếu địa chỉ email"),!1;if(!validateEmail(c))return m.html("Địa chỉ email không hợp lệ."),!1;m.html("");var l=e.find('input[name="txtCaptcha"]'),d=trim(l.val()),_=l.parent().find(".login-desc");if(4!=d.length)return _.html("Mã xác nhận không đúng"),l.focus(),!1;_.html("");var u={reason:o,captcha:d,captchaCode:e.find("#captchaID").val(),commentid:e.find("#btt_send_report_bad").attr("rel"),siteid:options.siteid,linkbad:s,cookie_aid:cookies("fosp_aid"),block_user:i,user_id:a};c.length&&(u.email=c);var p=trim(e.find('textarea[name="message"]').val());if(p.length&&"Nội dung phản hồi khác"!=p&&(u.message=p),"object"==typeof myvne_users&&"object"==typeof myvne_users.profile){var f=myvne_users.profile;f.user_id&&(u.userpost=f.user_id)}$.getJSON(server_url+"/index/reportbad?callback=?",u,function(e){if(e.error){if(10==e.error){$('input[name="txtCaptcha"]').parent().find(".login-desc").html("Mã xác nhận không đúng"),getCaptchaCode()}}else{cookies("report_bad_"+u.commentid,0,{expires:2400}),showAlertBox("Báo vi phạm thành công"),setTimeout(function(){hideAlertBox()},DELAY_TIME);try{dataLayer.push({event:"commentEvent",method:"",comment_action:"Report comment",user_id:void 0!==myvne_users.profile.user_id?myvne_users.profile.user_id:cookies("fosp_aid")})}catch(e){}}})},getReply=function(e){var t=$(e).closest(".comment_item").find(".sub_comment").find(".sub_comment_item").length,n=root.find(".filter_coment a[rel].active").attr("rel"),o={siteid:options.siteid,objectid:options.objectid,objecttype:options.objecttype,id:e.attr("rel"),limit:12,offset:t,cookie_aid:options.cookie_aid,sort_by:n};try{root.find(".loading").eq(0).clone().appendTo($(e).closest(".comment_item").find(".sub_comment")),$(e).closest(".comment_item").find(".sub_comment").find(".loading").css("padding","0px").css({display:"block",float:"none"})}catch(e){}e.hide(),$.ajax({data:o,url:server_url+"/index/getreplay",dataType:"json",success:function(t,n,o){if(!t.error){var i=$(e).closest(".comment_item").find(".sub_comment");$.each(t.data.items,function(e,t){void 0!==t.content&&i.append('<div class="sub_comment_item comment_item width_common">'+getCommentItemDetail(t,e)+"</div>")}),updateState_Reactions(t.data.items,o),addListenerForCommentDetail(i);try{VideoVNE.scrollContent(2)}catch(e){}var a=parseInt(e.data("total"));t.data.offset+=12,a>t.data.offset?(e.attr("data-offset",t.data.offset),e.show(),e.find(".num_reply_cmt").text(a-t.data.offset)):e.parent().remove();try{i.find(".loading").remove()}catch(e){}parseUserMyVNE(),parseEmbedLink(),void 0!==options.commentid&&focusToComment()}},timeout:3e4,error:function(e,t,n){}})},displayComment=function(e,t,n,o,i){0==options.offset&&listCommentEl.html("");var a="";if($.each(e,function(e,t){a+=getCommentItem(e,t,n,o)}),listCommentEl.append(a),addListenerForCommentDetail(listCommentEl),parseUserMyVNE(),parseEmbedLink(),listCommentEl.find(".view_more_coment").remove(),t>listCommentEl.find("> .comment_item").length){let e="",t="Xem thêm ý kiến";listCommentEl.append(`<div class="view_more_coment width_common mb10"><a id="show_more_coment" href="javascript:;" ${e} class="txt_666" title="${t}">${t}</a></div>`)}void 0!==options.commentid&&(root.children().children(".view_more_coment").hide(),focusToComment(options.commentid),delete options.commentid)},displayPinComment=function(e,t,n,o){if(e&&options.is_onload){var i="";$.each(e,function(e,t){i+=getCommentItem(e,t,n,o)}),i&&(listPinComment.append(i),wrapEditorComment.find(".wrap_pin_comment").show(),wrapEditorComment.show(),addListenerForCommentDetail(listPinComment))}},displayExpertComment=function(e,t,n,o){if(!e)return;t=t||0;let i="";if($.each(e,function(e,t){i+=getCommentItem(e,t,n,o)}),i&&(listExpertComment.append(i),wrapEditorComment.find(".wrap_expert_comment").show(),wrapEditorComment.show(),addListenerForCommentDetail(listExpertComment),parseUserMyVNE(),parseEmbedLink(),listExpertComment.find(".view_more_coment").remove(),t>listExpertComment.find("> .comment_item").length)){let e="",t="Xem thêm tư vấn";listExpertComment.append(`<div class="view_more_coment width_common mb10"><a id="show_more_coment" href="javascript:;" ${e} class="txt_666 more_expert_comment" title="${t}">${t}</a></div>`)}},getCommentItem=function(e,t,n,o){if(void 0===t.content)return"";var i=getCommentItemDetail(t,e),a=e%2?" hight_light_cmt":"",s=0;if(1==t.is_pin?a+=" vne_pin_comment":2==t.is_pin&&(a+=" expert_comment_item"),i+='<div class="sub_comment width_common clearfix">',void 0!==t.replys.total&&t.replys.total){if(void 0!==options.commentid&&options.commentid){var r=[];void 0!==t.replys.items&&(r=$.map(t.replys.items,function(e,t){return e.comment_id})),r.indexOf(parseInt(options.commentid))>-1&&($.each(t.replys.items,function(e,t){void 0!==t.content&&(i+='<div class="sub_comment_item comment_item width_common">'+getCommentItemDetail(t,e)+"</div>")}),s=r.length)}s=t.replys.total-s}return i+="</div>",s&&(i+='<p class="count-reply"><a href="javascript:;" class="view_all_reply" rel="'+t.comment_id+'" data-total="'+t.replys.total+'" data-offset="1"><span class="num_reply_cmt">'+s+"</span> trả lời</a></p>"),'<div class="comment_item width_common'+a+'">'+i+"</div>"},getCommentItemDetail=function(e,t){var n,o,i,a="javascript:;";0<e.userid&&void 0!==e.type&&4!=e.type&&"object"==typeof myvne_users&&void 0!==myvne_users.myvne_url&&(a=myvne_users.myvne_url+"/users/feed/"+e.userid,e.full_name),_objComments[e.comment_id]=e;var s=e.content;e.content=parseUrltoBcode(e.content),e.content=Emoticons.convertEmoji(e.content);var r=!!e.is_pin,c=r?"":'<span class="txt-name"><a class="nickname" href="'+a+'">'+html2text(e.full_name)+"</a></span>";55==options.objecttype||70==options.objecttype?n=e.content:s.replace(/<(?:.|\n)*?>|&nbsp;/gm,"").length>500?(s=parseUrltoBcode(cropText(s,460,500)),n='<p class="content_less" rel="content_more">'+c+(s=Emoticons.convertEmoji(s))+' ... <a class="icon_show_full_comment continue-reading" rel="content_more" href="javascript:void(0);" title="Xem đầy đủ nội dung">Đọc tiếp</a></p><p class="content_more" rel="content_less" style="display:none;">'+c+e.content+"</p>"):n='<p class="full_content">'+c+e.content+"</p>";return o=`\n            <div class="block_like_web width_common">\n                <div class="reactions-wrap">\n                    <a id="${(e=processOnOffReactions(e)).comment_id}" class="link_thich control-action" data-name="${getReactNameByType(e.like_ismember)}" href="javascript:;" rel="${e.comment_id}">\n                        ${e.like_ismember?"":'<i class="ic ic-like"></i>'}\n                        <span class="total_like">${getReactTextByType(e.like_ismember)}</span>\n                    </a>\n                    <div class="reactions-container">\n                        <div class="reactions-list reactions-menu" data-selected="">\n                            <div class="reaction-item">\n                                <button class="reaction" data-name="like" rel="${e.comment_id}"></button>\n                                <span class="label">Thích</span>\n                            </div>\n                            ${options.reactions&&1==options.reactions.funny?"":`<div class="reaction-item">\n                                    <button class="reaction" data-name="fun" rel="${e.comment_id}"></button>\n                                    <span class="label">Vui</span>\n                                </div>`}\n                            ${options.reactions&&1==options.reactions.wow?"":`<div class="reaction-item">\n                                    <button class="reaction" data-name="surprised" rel="${e.comment_id}"></button>\n                                    <span class="label">Ngạc nhiên</span>\n                                </div>`}\n                            ${options.reactions&&1==options.reactions.sad?"":`<div class="reaction-item">\n                                    <button class="reaction" data-name="sad" rel="${e.comment_id}"></button>\n                                    <span class="label">Buồn</span>\n                                </div>`}\n                        </div>\n                    </div>\n                    <div class="reactions-total" rel="${e.comment_id}" ${e.userlike<=0?'style="display:none"':""}>\n                        ${blockTotalReactions(e)}\n                        ${blockDetailReactions(e)}\n                    </div>\n                </div>\n                \n                <a id="${e.comment_id}" class="link_reply" href="javascript:;" rel="${e.comment_id}" parent="${e.parent_id}">Trả lời</a>\n                \n                \n                ${r?`<span class="time-com">${e.time}</span>`:`<a class="report-comment" rel="${e.comment_id}" uid-comment="${e.userid}" href="javascript:;" title="Báo vi phạm">\n                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n                            <path d="M4 9V3H12.0284L10.0931 5.70938C9.96896 5.88323 9.96896 6.11677 10.0931 6.29062L12.0284 9H4ZM4 10H13C13.4067 10 13.6432 9.54032 13.4069 9.20938L11.1145 6L13.4069 2.79062C13.6432 2.45968 13.4067 2 13 2H3.5C3.22386 2 3 2.22386 3 2.5V13.5C3 13.7761 3.22386 14 3.5 14C3.77614 14 4 13.7761 4 13.5V10Z" fill="#9F9F9F"></path>\n                        </svg>\n                        <span class="txt-vp">Báo vi phạm</span>\n                    </a>\n                    <span class="time-com">${e.time}</span>`}\n            </div>\n        `,i=`\n            <div class="user_status myuser" data-userid="${e.userid}" data-user-type="${e.type}">\n                <a class="avata_coment" href="${a}">${e.full_name.substr(0,1)}</a>\n            </div>\n        `,r&&(i=`\n                <div class="flexbox comment--editor__top chooses myuser" data-userid="${e.userid}" data-user-type="${e.type}">\n                    <div class="user_comment">\n                        <a class="avata_coment" href="${a}">${e.full_name.substr(0,1)}</a>\n                        <div class="user-name">\n                            <div class="name">\n                                <a class="nickname">${html2text(e.full_name)}</a>\n                            </div>\n                            <div class="time-com">${e.time}</div>\n                        </div>\n                    </div>\n                </div>\n            `),`\n            ${i}\n            <div class="content-comment">\n                ${n}\n                ${o}\n            </div>\n        `},cropText=function(e,t,n){var o=t;(e.substr(0,n).match(/<(?:.|\n)*?>|&nbsp;/gm)||"").length&&(o+=(e.substr(0,n).match(/<(?:.|\n)*?>|&nbsp;/gm)||"").join("").length);var i=e.lastIndexOf(" ",o);return e.substr(0,i).replace(/<br \/$|<br $|<br$/g,"")},html2text=function(e){var t=document.createElement("DIV");return t.innerHTML=e,t.textContent||t.innerText||""},showBlockShare=function(e){var t=$(".box_comment_vne").find("span.block_share_cmt_fb");t.length||((t=$('<span class="block_share_cmt_fb"></span>')).append('<a data-type="facebook" class="item_social item_fb" href="javascript:;" title="Chia sẻ phản hồi lên facebook"><i class="ic ic-facebook"></i></a>'),t.append('<a data-type="twitter" class="item_social item_twit" href="javascript:;" title="Chia sẻ phản hồi lên twitter"><i class="ic ic-twitter"></i></a>'),t.find("a").on("click",function(e){e.preventDefault(),shareComment($(this))})),t.attr("data-id")!=e.attr("rel")?(t.attr("data-id",e.attr("rel")),t.appendTo(e),t.show()):(t.removeAttr("data-id"),t.hide())},shareComment=function(e){var t=e.closest(".block_share_cmt_fb").attr("data-id"),n=e.parents(".comment_item ").find(".comment--editor__top").length?1:0,o=e.parents(".content-comment").find("> p:first").clone();o.find(".txt-name").remove(),o=o.text();var i=e.parents(".content-comment").find("> p:first").find("a.nickname").text();n&&(i=e.parents(".comment_item").find(".user-name a.nickname").text());var a=i+' bình luận : "'+(o=o.replace(i,""))+'"',s=e.attr("data-type"),r=window.location.protocol+"//"+window.location.host+window.location.pathname+"?commentid="+t;switch(s){case"facebook":var c="undefined"!=typeof article_image?article_image:"",m="https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(r)+"&t=&p[images][0]="+c+"&quote="+encodeURIComponent(a);window.open(m,"_blank","menubar=no,toolbar=no,resizable=no,scrollbars=no,height=450,width=710");break;case"google":m="https://plus.google.com/share?url="+encodeURIComponent(r);window.open(m,"_blank","menubar=no,toolbar=no,resizable=no,scrollbars=no,height=450,width=520");break;case"twitter":m='https://twitter.com/intent/tweet?source=webclient&text="'+o+'..." '+encodeURIComponent(r);window.open(m,"_blank","menubar=no,toolbar=no,resizable=no,scrollbars=no,height=450,width=710")}try{dataLayer.push({event:"commentEvent",method:s,comment_action:"Share comment",user_id:void 0!==myvne_users.profile.user_id?myvne_users.profile.user_id:cookies("fosp_aid")})}catch(e){}},addListenerForCommentDetail=function(e){e.find("a.view_all_reply").unbind("click"),e.find("a.view_all_reply").on("click",function(e){e.preventDefault();var t=$(this).closest(".comment_item").find(".sub_comment");t.find(".sub_comment_item:last").removeClass("end"),t.find(".sub_comment_item:hidden").show(),getReply($(this))}),e.find("a.link_reply").unbind("click"),e.find("a.link_reply").on("click",function(e){var t,n=$(this),o=+n.attr("parent"),i=+n.attr("rel"),a=root.find("#comment_reply_wrapper:last");e.preventDefault();var s=a.find(".txt_comment");if(s.attr("toogle")==n.attr("rel"))return s.attr("toogle",0),void a.hide();0==o||o==i?(t=n.parents(".comment_item").find(".sub_comment"),a.show().prependTo(t)):(t=n.parents(".sub_comment_item"),a.show().appendTo(t)),s.parents(".box-area-input").removeClass("input_error"),s.parents("form").find(".error_txt_cmt").css("display","none"),s.val(""),s.focus(),s.attr({rel:o>0?o:i,toogle:i}),s.attr("reply_to",o>0&&o!=i?i:0)}),e.find('a[class^="icon_"]').unbind("click"),e.find('a[class^="icon_"]').on("click",function(e){e.preventDefault();var t=$(this);t.parent().hide(),t.closest("div.content-comment").find("> p."+t.attr("rel")).show()}),e.find(".report-comment").unbind("click"),e.find(".report-comment").on("click",function(e){e.preventDefault(),showReportBadForm($(this))}),e.find("a.share_cmt_fb").unbind("click"),e.find("a.share_cmt_fb").on("click",function(e){e.preventDefault(),showBlockShare($(this))}),initEvent_Reactions(e)},parseUserMyVNE=function(){if("object"==typeof myvne_users&&void 0!==myvne_users.myvne_url){var e=[];if($(".box_comment_vne").find(".myuser").each(function(t){var n=$(this),o=n.data("userid");n.removeClass("myuser"),-1==$.inArray(o,e)&&e.push(o)}),!e.length)return;e.sort(),getScriptExt(myvne_users.myvne_url+"/apifrontend/getusersprofile",{myvne_users_id:e},function(e){displayUserMyVNE(e)})}},removeUrlParam=function(e,t){var n=e.split("?")[0],o=[],i=-1!==e.indexOf("?")?e.split("?")[1]:"";if(""!==i){for(var a=(o=i.split("&")).length-1;a>=0;a-=1)o[a].split("=")[0]===t&&o.splice(a,1);n=n+"?"+o.join("&")}return n},displayUserMyVNE=function(e){e.error||$.each(e.arrUsers,function(e,t){let n=t.consultant_status&&t.consultant_profile?t.consultant_profile:null;n&&(n.consultant_avatar&&(t.user_avatar=n.consultant_avatar),n.consultant_fullname&&(t.user_fullname=n.consultant_fullname)),-1===(n&&n.consultant_category?String(n.consultant_category):"").indexOf(options.categoryid)&&(n=null);var o=root.find('div[data-userid="'+t.user_id+'"]'),i=root.find('span[data-userid="'+t.user_id+'"]');if(void 0===t.user_email||null!=t.user_fullname&&""!=t.user_fullname||(t.user_fullname=t.user_email.replace(/@.*/,"")),n){let e=`\n                        <div class="flexbox comment--editor__top chooses" data-userid="${t.user_id}">\n                            <div class="user_comment">\n                                <a class="avata_coment" href="javascript:;">${t.user_fullname.substr(0,1)}</a>\n                                <div class="user-name">\n                                    <div class="name">\n                                        <a class="nickname">${n.consultant_fullname?n.consultant_fullname:t.user_fullname}</a>\n                                        ${n.consultant_description?`<a class="hint" href="javascript:;"></a>\n                                            <div class="info">\n                                                <p>${n.consultant_description}</p>\n                                                <a class="close" href="javascript:;" title="Đóng">Đóng</a>\n                                            </div>`:""}\n                                    </div>\n                                    <div class="time-com">${n.consultant_title?n.consultant_title:""}</div>\n                                </div>\n                            </div>\n                        </div>\n                    `;o.closest(".comment_item").find(".content-comment .txt-name").remove(),o.replaceWith(e),o=root.find('div[data-userid="'+t.user_id+'"]')}i.length&&i.each(function(){$(this).html('<a href="'+myvne_users.myvne_url+"/users/feed/"+t.user_id+'" title="Xem trang ý kiến của '+t.user_fullname+'" target="_blank" rel="noopener" class="reply_name">@'+t.user_fullname+"</a>"),$(this).removeAttr("data-userid"),void 0!==t.status&&1!=t.status&&$(this).find("a.reply_name").removeAttr("href")}),o.length&&(o.each(function(){var e=!!$(this).closest(".comment_item").hasClass("vne_pin_comment");t.user_avatar=t.user_avatar.replace("/src/","/c60x60/");var n=$(this).find("a.avata_coment"),o=myvne_users.myvne_url+"/users/feed/"+t.user_id,i=$(this).closest(".comment_item").children(".content-comment, .user_comment").find("a.nickname");"undefined"!=typeof ZONE_ADS&&1==ZONE_ADS&&(t.user_avatar=t.user_avatar.replace("//a.vnecdn","//vcdn-a.vnecdn"),t.user_avatar=t.user_avatar.replace("//s.vnecdn","//scdn.vnecdn")),n.find("img.img_avatar").remove(),n.html('<img class="img_avatar" src="'+t.user_avatar+'">'),n.find("img.img_avatar").onerror=function(){n.find("img.img_avatar").attr("src","https://s.vnecdn.net/myvne/i/v1/graphics/img_60x60.gif")},n.attr({href:o,title:"Xem trang ý kiến của "+t.user_fullname}),i.attr({href:o}).html(t.user_fullname),t.user_avatar.indexOf("img_60x60.gif")>-1&&(n.find("img.img_avatar").remove(),t.user_fullname.length?n.html(t.user_fullname.substr(0,1)):n.html(t.user_email.substr(0,1))),$(this).removeAttr("data-userid"),void 0!==t.status&&1!=t.status&&(i.removeAttr("href"),n.removeAttr("href")),e&&$(this).append(`\n                                <div class="editor-select">\n                                    <span class="icons">\n                                        <img src="${css_url_vne}/v2/wcomment/pc/vne/images/graphics/icon-vne.svg">\n                                    </span>\n                                    <span class="text">Biên tập viên chọn</span>\n                                </div>\n                            `),$("[data-author-id]").length&&$("[data-author-id]").attr("data-author-id")==t.author_id&&e&&i.addClass("checked")}),void 0!==t.author_id&&t.author_id&&$("[data-author-id]").length&&$("[data-author-id]").attr("data-author-id")==t.author_id&&o.parent().find(".content-comment .txt-name").addClass("user-gocnhin"))})},addToolTip=function(e,t){e.find(".info_avata_cmt").remove();var n=t.content,o=n.split(" ");o.length>25&&(n=o.splice(0,25).join(" ")+" ...");var i=void 0!==t.total_feed?format_number(t.total_feed):0,a=void 0!==t.title?t.title:"",s="javascript:;;",r=myvne_users.myvne_url+"/users/feed/"+t.user_id;void 0!==t.share_url&&void 0!==t.comment_id&&(s=t.share_url+"?commentid="+t.comment_id);var c="";void 0!==t.author_id&&t.author_id&&$("[data-author-id]").length&&$("[data-author-id]").attr("data-author-id")==t.author_id&&(c="author-gn");var m=`\n        <div class="info_avata_cmt">\n            <a href="${r}" class="avata_coment" target="_blank"><img src="${t.user_avatar}" alt="${t.user_fullname}"></a>\n            <p class="author-info">\n                <a href="${r}" target="_blank" class="${c}"><b>${t.user_fullname}</b></a>\n                <span class="txt_author">${""!=c?"Tác giả - ":""}<span class="count-yk">${i} ý kiến</span></span>\n            </p>\n            <p class="recent-com">\n                <a href="${s}">${n}</a>\n            </p>\n            ${a.length?`<p class="title-art">\n                    <strong><a href="${s}">${a}</a></strong>\n                </p>`:""}\n        </div>`;e.find(".avata_coment").append(m),e.parent().find(".nickname:first").append(m)},setUiMyVNE=function(e){let t="object"==typeof myvne_users&&myvne_users.profile&&myvne_users.profile.consultant_status&&myvne_users.profile.consultant_profile?myvne_users.profile.consultant_profile:null;t&&(t.consultant_avatar&&(myvne_users.profile.user_avatar=t.consultant_avatar),t.consultant_fullname&&(myvne_users.profile.user_fullname=t.consultant_fullname));var n=e||myvne_users.profile,o=root.find(".like_google"),i='<div class="block_input_anonymous"><div class="left input_50"><div class="box_input_txt width_common"><input type="email" placeholder="Email" class="input_anonymous txt_email">  <span id="error_email" class="error_lk"></span></div></div><div class="left input_50"><div class="box_input_txt width_common"><input type="text" placeholder="Họ và tên" class="input_anonymous txt_fullname">  <span id="error_fullname" class="error_lk"></span></div></div></div>';if(void 0===n||void 0===n.user_id||!n.user_id)return root.find(".block_anonymous").html('<p class="not_login">Hãy <a href="javascript:;" id="login_cmt" class="login_cmt">đăng nhập</a> hoặc <a href="javascript:;" class="register_cmt">tạo tài khoản</a> để gửi bình luận</p>'),o.html(""),anonymous_selected&&(root.find(".block_anonymous").html(i).show(),void 0!==check_myvne_interval&&clearInterval(check_myvne_interval)),void initEventLogin();if(!anonymous_selected||void 0!==n&&void 0!==n.user_id&&n.user_id)if(anonymous_selected=0,root.find(".block_anonymous").html(""),""==n.user_fullname||null==n.user_fullname)o.html(""),root.find(".block_anonymous").html('<div class="box_input_txt width_common"><input type="text" placeholder="Họ và tên" class="input_anonymous txt_fullname">  <span id="error_fullname" class="error_lk"></span></div>').show(),void 0!==check_myvne_interval&&clearInterval(check_myvne_interval);else{var a="";a+='<div class="google_name"><a class="avata_coment" href="'+myvne_users.myvne_url+"/users/feed/"+n.user_id+'" target="_blank">',n.user_avatar.indexOf("img_60x60.gif")>-1?n.user_fullname.length?a+=n.user_fullname.substr(0,1):a+=n.user_email.substr(0,1):a+='<img src="'+n.user_avatar.replace("/src/","/c60x60/")+'" alt="'+n.user_fullname+'">',a+="</a>",a+="<span>"+n.user_fullname+"</span>",a+="</div>",o.html(a).show()}else root.find(".block_anonymous").html(i).show(),void 0!==check_myvne_interval&&clearInterval(check_myvne_interval)},focusToComment=function(e){e=e||options.commentid;var t=root.find('[id="'+e+'"]');if(t.length){var n=function(){var e;e=t.closest(".sub_comment_item").length?t.closest(".sub_comment_item").offset().top:t.closest(".comment_item").offset().top,window.scroll({top:e-50,left:0,behavior:"smooth"})},o=getParameter("focus");n(),setTimeout(function(){n()},800),setTimeout(function(){n(),"reply"==o?root.find('.link_reply[id="'+e+'"]').trigger("click"):"report"==o&&setTimeout(function(){root.find('.report-comment[rel="'+e+'"]').trigger("click")},500)},1500)}delete options.commentid},getComments=function(e){void 0!==options.objectid&&void 0!==options.objecttype||log("Vui long set objectid va objecttype"),$('.filter_coment a[rel="like"]').hasClass("active")||$('.filter_coment_mobile a[rel="like"]').hasClass("active")?sortedBy("like"):$('.filter_coment a[rel="vne"]').hasClass("active")||$('.filter_coment_mobile a[rel="vne"]').hasClass("active")?sortedBy("vne"):sortedBy("time"),getCommentByLike(e)},getCommentByLike=function(e){let t=Object.assign({},options);return 0==t.offset?t.limit=_numberCommentToShow:t.limit=options.limit,$.ajax({data:t,url:server_url+"/index/get",dataType:"json",success:function(t,n,o){var i=-1;if(!t.error){if(t.data.totalitem)listCommentEl.show(),void 0!==t.data.offset&&(options.offset=t.data.offset),setTotalComment(t.data.totalitem,t.data.total),"vne"==options.sort_by&&t.data.total_pin<5&&1==options.is_onload&&(options.sort_by="like"),displayPinComment(t.data.items_pin,t.data.total,options.template_type,!1),displayExpertComment(t.data.items_expert,t.data.total_expert,options.template_type,!1),displayComment(t.data.items,t.data.total,options.template_type,!1,t.data.total_pin),updateState_Reactions(t.data.items,o),0==t.data.total&&(root.find(">> .filter_coment").hide(),listCommentEl.hide());else{var a="Ý kiến";"undefined"!=typeof IS_EVISUAL&&IS_EVISUAL&&(a="Comment"),$("#box_comment_vne").addClass("no-viewmore"),$("#cmt-paginator").hide(),root.find(".ykien_vne .left").html('<h3 style="display:inline-block;font-weight:bold;" rel="time">'+a+"</h3>"),root.find(".filter_coment").hide(),listCommentEl.hide(),root.find(".empty-comment").remove()}i=t.data.totalitem}if(1002764==site_id_cmt&&root.find(".ykien_vne .left h3").text("Comments"),root.find(".loading").css("display","none"),$(".box_comment_vne").show(),"function"==typeof e&&e(i),"undefined"!=typeof sessionStorage&&sessionStorage.view_comment){const e=+sessionStorage.view_comment;sessionStorage.removeItem("view_comment"),1==e&&setTimeout(()=>{const e=document.querySelector("#show_more_coment");if(e&&cookies("myvne_user_id")){smoothScroll("#show_more_coment",1e3,-200,()=>{e.click()})}},1e3)}},timeout:3e4,error:function(e,t,n){"timeout"===t&&(root.find(".loading").css("display","none"),$("#cmt-paginator").hide(),root.find(".ykien_vne .left").html('<h3 style="display:inline-block;font-weight:bold;" rel="time">Ý kiến</h3>'),root.find(".filter_coment").hide(),listCommentEl.hide(),root.find(".empty-comment").remove()),"undefined"!=typeof sessionStorage&&sessionStorage.removeItem("view_comment")}}),!0},getContentComment=function(){var e=useReply?$("#comment_reply_form").find(".txt_comment"):$("#comment_post_form").find(".txt_comment"),t=e.attr("rel"),n=e.attr("reply_to");return 0!=useReply&&t||(t=0),0==t&&(n=0),{content:trim(e.val()),parent_id:t,reply_to:n}},initEvent=function(){var e;root.unbind("click"),root.on("click",".filter_coment a[rel]",function(e){e.preventDefault();var t=$(this);t.hasClass("active")||(root.find("#comment_reply_wrapper:last").hide().appendTo(".box_comment_vne"),options.is_onload=0,t.parents(".filter_coment").find("a").removeClass("active"),t.addClass("active"),setTimeout(()=>{getComments()},0))}),root.on("click","#show_more_coment",function(e){e.preventDefault();try{dataLayer.push({event:"commentEvent",method:"",comment_action:"View more comments"})}catch(e){}$(this).hasClass("more_expert_comment")?(options.sort_by="expert",options.offset=root.find("#list_expert_comment > .comment_item").length):(options.sort_by=root.find(".filter_coment a[rel].active").attr("rel"),options.offset=listCommentEl.find("> .comment_item").length),options.is_onload=0,_getMoreComment(options,$(this))}),root.find("textarea").unbind("keydown");root.find("textarea").on("keydown",function(t){clearTimeout(e)});root.find("textarea").each(function(){this.setAttribute("style","overflow-y:hidden;")}).on("input",function(){this.style.height="auto";var e=18;e=root.hasClass("widget_comment_article")?this.scrollHeight>18?this.scrollHeight:18:this.scrollHeight>76?this.scrollHeight:76,this.style.height=e+"px"}),root.find("textarea").unbind("keyup"),root.find("textarea").on("keyup",function(){useReply="comment_reply_form"===$(this).parents("form").attr("id")?1:0,$(this).val().trim().length>0?$(this).parents(".box-area-input").hasClass("input_error")&&($(this).parents(".box-area-input").removeClass("input_error"),$(this).parents("form").find(".error_txt_cmt").css("display","none")):($(this).parents(".box-area-input").addClass("input_error"),$(this).parents("form").find(".error_txt_cmt").css("display","block"));var t=$(this);clearTimeout(e),e=setTimeout(function(){var e;validate_Link(e=t),validate_Emoji(e)},500)}),root.find("textarea").unbind("click"),root.find("textarea").on("click",function(e){if(e.stopPropagation(),1002764!=site_id_cmt){if("object"!=typeof myvne_users||void 0!==myvne_users.profile.user_id||anonymous_selected||openPopupMyVnE(),null==cookies("action_type ")||""==cookies("action_type ")){!function(e,t,n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);var i="expires="+o.toUTCString();document.cookie=e+"="+t+";"+i+";path=/;domain=.vnexpress.net"}("action_type","comment",1/24/12)}}else if("object"!=typeof myvne_users||void 0!==myvne_users.profile.user_id||anonymous_selected||openPopupMyVnE(),4==device_env&&$(".both-content .box_comment_vne").length)try{$(".wrapper .sidebar_right .inner-sidebar-right").niceScroll({cursorwidth:"5px",cursorcolor:"#dedede",autohidemode:"false",cursorborder:"none"}).resize()}catch(e){console.log("Danh sách Bí thư các tỉnh/thành nhiệm kỳ 2020-2025")}}),root.find("textarea").unbind("focusin"),root.find("textarea").on("focusin",function(e){if(e.stopPropagation(),useReply="comment_reply_form"===$(this).parents("form").attr("id")?1:0,0==$(".box_comment_vne .block_relative .not_login").length){if("object"==typeof myvne_users&&void 0!==myvne_users.profile.user_id||anonymous_selected)if($(this).parents(".input_comment").find(".block_relative").css("display","block"),root.hasClass("widget_comment_article"))$(this).parents("form").addClass("active-comment width_common");else{var t=$(this).get(0).scrollHeight;(t<76||0==$(this).val().trim().length)&&(t=76),$(this).css({height:t+"px"})}if(4==device_env&&$(".both-content .box_comment_vne").length)try{$(".wrapper .sidebar_right .inner-sidebar-right").niceScroll({cursorwidth:"5px",cursorcolor:"#dedede",autohidemode:"false",cursorborder:"none"}).resize()}catch(e){console.log("Danh sách Bí thư các tỉnh/thành nhiệm kỳ 2020-2025")}validate_Link($(this)),validate_Emoji($(this))}}),root.find(".btn_cancel_comment").on("click",function(e){$(this).closest(".input_comment").find(".block_relative").hide(),$(this).closest(".input_comment").find("textarea").removeAttr("style"),$(this).closest(".input_comment").find("form").removeClass("active-comment"),$(this).closest(".input_comment").find(".error_txt_cmt").hide()}),root.on("click",".hint",function(){return $(this).next(".info").addClass("open"),!1}),root.on("click",".info .close",function(){return $(this).parents(".info").removeClass("open"),!1})},initEventLogin=function(){root.find(".login_cmt").on("click",function(){"object"==typeof myvne_users&&"function"==typeof myvne_users.authentication&&openPopupMyVnE()}),root.find(".register_cmt").on("click",function(){"object"==typeof myvne_users&&"function"==typeof myvne_users.authentication&&(null==cookies("myvne_user_id")||""==cookies("myvne_user_id")?myvne_users._html_popup_register():openPopupMyVnE())})},setAnonymous=function(){anonymous_selected=1,setUiMyVNE()},unSetAnonymous=function(){anonymous_selected=0,setUiMyVNE()},md5=function(e){var t,n,o,i,a,s,r,c,m,l,d,_=function(e,t){return e<<t|e>>>32-t},u=function(e,t){var n,o,i,a,s;return i=2147483648&e,a=2147483648&t,s=(1073741823&e)+(1073741823&t),(n=1073741824&e)&(o=1073741824&t)?2147483648^s^i^a:n|o?1073741824&s?3221225472^s^i^a:1073741824^s^i^a:s^i^a},p=function(e,t,n,o,i,a,s){return e=u(e,u(u(function(e,t,n){return e&t|~e&n}(t,n,o),i),s)),u(_(e,a),t)},f=function(e,t,n,o,i,a,s){return e=u(e,u(u(function(e,t,n){return e&n|t&~n}(t,n,o),i),s)),u(_(e,a),t)},v=function(e,t,n,o,i,a,s){return e=u(e,u(u(function(e,t,n){return e^t^n}(t,n,o),i),s)),u(_(e,a),t)},h=function(e,t,n,o,i,a,s){return e=u(e,u(u(function(e,t,n){return t^(e|~n)}(t,n,o),i),s)),u(_(e,a),t)},g=function(e){var t,n="",o="";for(t=0;t<=3;t++)n+=(o="0"+(e>>>8*t&255).toString(16)).substr(o.length-2,2);return n};for(c=1732584193,m=4023233417,l=2562383102,d=271733878,t=(n=function(e){for(var t,n=e.length,o=n+8,i=16*((o-o%64)/64+1),a=new Array(i-1),s=0,r=0;r<n;)s=r%4*8,a[t=(r-r%4)/4]=a[t]|e.charCodeAt(r)<<s,r++;return s=r%4*8,a[t=(r-r%4)/4]=a[t]|128<<s,a[i-2]=n<<3,a[i-1]=n>>>29,a}(e=function(e){if(null==e)return"";var t,n,o,i=e+"",a="";t=n=0,o=i.length;for(var s=0;s<o;s++){var r=i.charCodeAt(s),c=null;if(r<128)n++;else if(r>127&&r<2048)c=String.fromCharCode(r>>6|192,63&r|128);else if(55296!=(63488&r))c=String.fromCharCode(r>>12|224,r>>6&63|128,63&r|128);else{if(55296!=(64512&r))throw new RangeError("Unmatched trail surrogate at "+s);var m=i.charCodeAt(++s);if(56320!=(64512&m))throw new RangeError("Unmatched lead surrogate at "+(s-1));r=((1023&r)<<10)+(1023&m)+65536,c=String.fromCharCode(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}null!==c&&(n>t&&(a+=i.slice(t,n)),a+=c,t=n=s+1)}return n>t&&(a+=i.slice(t,o)),a}(e))).length,o=0;o<t;o+=16)i=c,a=m,s=l,r=d,c=p(c,m,l,d,n[o+0],7,3614090360),d=p(d,c,m,l,n[o+1],12,3905402710),l=p(l,d,c,m,n[o+2],17,606105819),m=p(m,l,d,c,n[o+3],22,3250441966),c=p(c,m,l,d,n[o+4],7,4118548399),d=p(d,c,m,l,n[o+5],12,1200080426),l=p(l,d,c,m,n[o+6],17,2821735955),m=p(m,l,d,c,n[o+7],22,4249261313),c=p(c,m,l,d,n[o+8],7,1770035416),d=p(d,c,m,l,n[o+9],12,2336552879),l=p(l,d,c,m,n[o+10],17,4294925233),m=p(m,l,d,c,n[o+11],22,2304563134),c=p(c,m,l,d,n[o+12],7,1804603682),d=p(d,c,m,l,n[o+13],12,4254626195),l=p(l,d,c,m,n[o+14],17,2792965006),c=f(c,m=p(m,l,d,c,n[o+15],22,1236535329),l,d,n[o+1],5,4129170786),d=f(d,c,m,l,n[o+6],9,3225465664),l=f(l,d,c,m,n[o+11],14,643717713),m=f(m,l,d,c,n[o+0],20,3921069994),c=f(c,m,l,d,n[o+5],5,3593408605),d=f(d,c,m,l,n[o+10],9,38016083),l=f(l,d,c,m,n[o+15],14,3634488961),m=f(m,l,d,c,n[o+4],20,3889429448),c=f(c,m,l,d,n[o+9],5,568446438),d=f(d,c,m,l,n[o+14],9,3275163606),l=f(l,d,c,m,n[o+3],14,4107603335),m=f(m,l,d,c,n[o+8],20,1163531501),c=f(c,m,l,d,n[o+13],5,2850285829),d=f(d,c,m,l,n[o+2],9,4243563512),l=f(l,d,c,m,n[o+7],14,1735328473),c=v(c,m=f(m,l,d,c,n[o+12],20,2368359562),l,d,n[o+5],4,4294588738),d=v(d,c,m,l,n[o+8],11,2272392833),l=v(l,d,c,m,n[o+11],16,1839030562),m=v(m,l,d,c,n[o+14],23,4259657740),c=v(c,m,l,d,n[o+1],4,2763975236),d=v(d,c,m,l,n[o+4],11,1272893353),l=v(l,d,c,m,n[o+7],16,4139469664),m=v(m,l,d,c,n[o+10],23,3200236656),c=v(c,m,l,d,n[o+13],4,681279174),d=v(d,c,m,l,n[o+0],11,3936430074),l=v(l,d,c,m,n[o+3],16,3572445317),m=v(m,l,d,c,n[o+6],23,76029189),c=v(c,m,l,d,n[o+9],4,3654602809),d=v(d,c,m,l,n[o+12],11,3873151461),l=v(l,d,c,m,n[o+15],16,530742520),c=h(c,m=v(m,l,d,c,n[o+2],23,3299628645),l,d,n[o+0],6,4096336452),d=h(d,c,m,l,n[o+7],10,1126891415),l=h(l,d,c,m,n[o+14],15,2878612391),m=h(m,l,d,c,n[o+5],21,4237533241),c=h(c,m,l,d,n[o+12],6,1700485571),d=h(d,c,m,l,n[o+3],10,2399980690),l=h(l,d,c,m,n[o+10],15,4293915773),m=h(m,l,d,c,n[o+1],21,2240044497),c=h(c,m,l,d,n[o+8],6,1873313359),d=h(d,c,m,l,n[o+15],10,4264355552),l=h(l,d,c,m,n[o+6],15,2734768916),m=h(m,l,d,c,n[o+13],21,1309151649),c=h(c,m,l,d,n[o+4],6,4149444226),d=h(d,c,m,l,n[o+11],10,3174756917),l=h(l,d,c,m,n[o+2],15,718787259),m=h(m,l,d,c,n[o+9],21,3951481745),c=u(c,i),m=u(m,a),l=u(l,s),d=u(d,r);return(g(c)+g(m)+g(l)+g(d)).toLowerCase()},getAuthentication=function(e){$.ajax({url:`${server_url}/api/cf`,type:"GET",dataType:"json",xhrFields:{withCredentials:!0},success:function(t){"function"==typeof e&&e(t)},timeout:1e4,error:function(e,t,n){}})},processOnOffReactions=function(e){var t=JSON.parse(JSON.stringify(e));return options.reactions&&(options.reactions.funny&&1==options.reactions.funny&&(t.t_r_2=0),options.reactions.wow&&1==options.reactions.wow&&(t.t_r_3=0),options.reactions.sad&&1==options.reactions.sad&&(t.t_r_4=0),options.reactions.funny&&1==options.reactions.funny&&1002==t.like_ismember&&(t.like_ismember=!1),options.reactions.wow&&1==options.reactions.wow&&1003==t.like_ismember&&(t.like_ismember=!1),options.reactions.sad&&1==options.reactions.sad&&1004==t.like_ismember&&(t.like_ismember=!1)),t},blockTotalReactions=function(e){var t=[],n=[],o=(e.t_r_1>0?e.t_r_1:0)+(e.t_r_2>0?e.t_r_2:0)+(e.t_r_3>0?e.t_r_3:0)+(e.t_r_4>0?e.t_r_4:0),i=getReactNameByType(e.like_ismember);if(i&&n.push(`<span class="item ${i}"><img src="${css_url_vne}/v2/wcomment/pc/vne/images/graphics/${i}.svg"></span>`),o>0){var a=e.t_r_1/o*100,s=e.t_r_2/o*100,r=e.t_r_3/o*100,c=e.t_r_4/o*100;(e.t_r_1>=8||a>=5)&&t.push([e.t_r_1,`<span class="item like"><img src="${css_url_vne}/v2/wcomment/pc/vne/images/graphics/like.svg"></span>`]),(e.t_r_2>=8||s>=5)&&t.push([e.t_r_2,`<span class="item fun"><img src="${css_url_vne}/v2/wcomment/pc/vne/images/graphics/fun.svg"></span>`]),(e.t_r_3>=8||r>=5)&&t.push([e.t_r_3,`<span class="item surprised"><img src="${css_url_vne}/v2/wcomment/pc/vne/images/graphics/surprised.svg"></span>`]),(e.t_r_4>=8||c>=5)&&t.push([e.t_r_4,`<span class="item sad"><img src="${css_url_vne}/v2/wcomment/pc/vne/images/graphics/sad.svg"></span>`]),t.sort(function(e,t){return t[0]-e[0]}),t.forEach(e=>{-1===n.indexOf(e[1])&&n.push(e[1])}),n=n.slice(0,3)}return`\n            ${n.join("")}\n            <a class="number" href="javascript:;">${o>0?format_number(o):""}</a>\n        `},blockDetailReactions=function(e){var t="";return e.t_r_1>0&&(t+=`\n                <div class="item t_r_1">\n                    <span class="icons"><img src="${css_url_vne}/v2/wcomment/pc/vne/images/graphics/like.svg" alt="Thích"></span>\n                    <strong>${format_number(e.t_r_1)}</strong>\n                </div>\n            `),e.t_r_2>0&&(t+=`\n                <div class="item t_r_2">\n                    <span class="icons"><img src="${css_url_vne}/v2/wcomment/pc/vne/images/graphics/fun.svg" alt="Vui"></span>\n                    <strong>${format_number(e.t_r_2)}</strong>\n                </div>\n            `),e.t_r_3>0&&(t+=`\n                <div class="item t_r_3">\n                    <span class="icons"><img src="${css_url_vne}/v2/wcomment/pc/vne/images/graphics/surprised.svg" alt="Ngạc nhiên"></span>\n                    <strong>${format_number(e.t_r_3)}</strong>\n                </div>\n            `),e.t_r_4>0&&(t+=`\n                <div class="item t_r_4">\n                    <span class="icons"><img src="${css_url_vne}/v2/wcomment/pc/vne/images/graphics/sad.svg" alt="Buồn"></span>\n                    <strong>${format_number(e.t_r_4)}</strong>\n                </div>\n            `),`<div class="reactions-detail">${t}</div>`},filldetailReactions=function(e,t=1,n=null){e=processOnOffReactions(e);var o=$(`.reactions-total[rel="${e.comment_id}"]`),i=o.parents(".reactions-wrap"),a=(e.t_r_1>0?e.t_r_1:0)+(e.t_r_2>0?e.t_r_2:0)+(e.t_r_3>0?e.t_r_3:0)+(e.t_r_4>0?e.t_r_4:0);e.like_ismember=!(1!=t||!n)&&n,o.html(blockTotalReactions(e)+blockDetailReactions(e)),i.find(".reactions-total").css("display","none"),i.find(".reactions-total .number").html(""),a>0&&(i.find(".reactions-total").css("display","flex"),i.find(".reactions-total .number").html(format_number(a))),n&&(i.find(".control-action").attr("data-name",null),i.find(".control-action").html('<i class="ic ic-like"></i><span class="total_like">Thích</span>'),1==t&&(i.find(".control-action").attr("data-name",getReactNameByType(n)),i.find(".control-action").html(`<span class="total_like">${getReactTextByType(n)}</span>`)))},getReactTextByType=function(e){var t="Thích";switch(+e){case 1001:t="Thích";break;case 1002:t="Vui";break;case 1003:t="Ngạc nhiên";break;case 1004:t="Buồn"}return t},getReactNameByType=function(e){var t="";switch(+e){case 1001:t="like";break;case 1002:t="fun";break;case 1003:t="surprised";break;case 1004:t="sad"}return t},getLikeTypeByName=function(e){var t=1001;switch(e){case"like":t=1001;break;case"fun":t=1002;break;case"surprised":t=1003;break;case"sad":t=1004}return t},getKeyName_ReactType=function(e){return"t_r_"+(+e-1e3)},getStorage_React=function(e){var t;try{var n=(new Date).getTime()/1e3,o=localStorage.getItem(key_user_react);if((o=o?JSON.parse(o):{})[e])n-(t=o[e]).time>=86400&&(t=null,delete o[e],localStorage.setItem(key_user_react,JSON.stringify(o)))}catch(e){console.log("getStorage_React error:: ",e),t=null}return t},setStorage_React=function(e,t){var n;try{var o=Math.round((new Date).getTime()/1e3),i={},a=localStorage.getItem(key_user_react),s=_objComments[e],r=getInfoUserReact(e,t),c=getKeyName_ReactType(r.old_react_type),m=getKeyName_ReactType(r.new_react_type),l={};if(r.old_react_type)if(r.old_react_type==r.new_react_type){var d=r.status?1:-1;l.total_like=d,l[c]=d}else l.total_like=0,l[m]=1,l[c]=-1;else l.total_like=1,l[m]=1;l.total_like&&(s.userlike+=l.total_like),$.each(l,function(e,t){void 0!==s[e]&&(s[e]+=t)}),a&&(i=JSON.parse(a)),i[e]||(i[e]={data:[]}),i[e].time=o,i[e].data.push(+t),i[e].last_status=r.status,i[e].last_inc=l;var _=Object.keys(i);_.length>50&&(_.sort((e,t)=>i[t].time-i[e].time),_.slice(50).forEach(e=>delete i[e])),localStorage.setItem(key_user_react,JSON.stringify(i)),n=1}catch(e){console.log("setStorage_React error:: ",e),n=0}return n},getInfoUserReact=function(e,t){var n=(new Date).getTime()/1e3,o=_objComments[e],i=getStorage_React(e),a={old_react_type:o.like_ismember,new_react_type:t,status:1};if(o.like_ismember==t&&(a.status=0),i){var s=n-i.time;if(a.old_react_type=i.data.slice(-1)[0],a.old_react_type==t)a.status=0,i.data.slice(-2,-1)[0]==t&&(a.status=1);i.data.length>2&&s<86400&&(a.status=-1)}return a},likeComment=function(e){var t={},n=e.attr("data-name")?e.attr("data-name"):"like",o=getLikeTypeByName(n),i=+e.attr("rel"),a=getInfoUserReact(i,o);if(-1==a.status)return showAlertBox("Bạn đã sử dụng chức năng này. Bạn phải đợi 24h nữa mới được thao tác tiếp");setStorage_React(i,o);var s=_objComments[i];if(t.site_id=options.siteid,t.comment_id=i,t.react_type=o,t.status=a.status,t.object_id=+options.objectid,t.object_type=+options.objecttype,t.url=document.location.href,t._cmt_token="","object"==typeof myvne_users&&"object"==typeof myvne_users.profile){var r=myvne_users.profile;r.user_id&&(t.userid=r.user_id,t.token_key=r.user_session)}filldetailReactions(s,t.status,o);try{(egg=window._logEgg||[]).push({action:"like"})}catch(e){}try{dataLayer.push({event:"commentEvent",method:"",comment_action:"Like comment"})}catch(e){}try{"undefined"!=typeof vneNotify&&"undefined"!=vneNotify.setLiveComment&&vneNotify.setLiveComment()}catch(e){console.log("webpush error",e)}return loadCaptchaV3(t.site_id,function(e){t._cmt_token=e,getAuthentication(function(e){t.t=e.t,t._csrf=e._t;var n=String(t.react_type)+String(t.comment_id)+String(t.status)+String(t.object_id)+String(t.object_type)+String(t.t)+String(t._csrf);t.sign=md5(n),$.ajax({url:server_url+"/post/cmt/like",type:"POST",dataType:"json",data:t,xhrFields:{withCredentials:!0},success:function(e){},timeout:5e3,error:function(e,t,n){}})})}),!1},updateState_Reactions=function(e,t){$.each(e,function(e,t){var n=t.comment_id,o=getStorage_React(n),i=+t.like_ismember;if(o){var a=+o.data.slice(-1)[0];if(i!=a&&1==o.last_status){var s=o.last_inc;s.total_like&&(t.userlike+=s.total_like),$.each(s,function(e,n){void 0!==t[e]&&(t[e]+=n)}),filldetailReactions(t,o.last_status,a)}}})},initEvent_Reactions=function(e){const t=e.find(".reactions-wrap"),n=e.find(".reactions-container"),o=e.find(".reactions-list"),i=e.find(".control-action");let a=null,s=null,r=!1;i.unbind("mouseenter"),i.on("mouseenter",function(e){var t=$(this);s=setTimeout(function(){m(),t.parents(".reactions-wrap").find(".reactions-container").addClass("show")},750)}),i.unbind("mouseleave"),i.on("mouseleave",function(e){var t=$(this);clearTimeout(s),setTimeout(function(){r||t.parents(".reactions-wrap").find(".reactions-container").removeClass("show")},750)}),n.unbind("mouseenter"),n.on("mouseenter",function(e){r=!0}),n.unbind("mouseleave"),n.on("mouseleave",function(e){var t=$(this);r=!1,setTimeout(function(){r||t.parents(".reactions-wrap").find(".reactions-container").removeClass("show")},750)}),o.unbind("mouseover"),o.on("mouseover",function(e){const t=e.target;t.classList.contains("reaction")&&(a=t.dataset.name,$(this).attr("data-selected",a))}),o.unbind("mouseout"),o.on("mouseout",function(){$(this).attr("data-selected",""),a=null}),o.find(".reaction").unbind("click"),o.find(".reaction").on("click",function(e){var t=$(this);t.parents(".reactions-container").removeClass("show"),t.parents(".reactions-list").attr("data-selected",null),likeComment(t)}),t.find(".link_thich").unbind("click"),t.find(".link_thich").on("click",function(e){e.preventDefault();var t=$(this);likeComment(t),clearTimeout(s),setTimeout(()=>{clearTimeout(s),t.parents(".reactions-container").removeClass("show")},50)});const c=e.find(".reactions-total");function m(){$(".reactions-detail").css("display","none").removeClass("active"),$(".reactions-container").removeClass("show")}t.unbind("mouseenter"),t.on("mouseenter",function(e){r=!0}),t.unbind("mouseleave"),t.on("mouseleave",function(e){$(this);r=!1,setTimeout(function(){r||m()},500)}),c.unbind("mouseenter"),c.on("mouseenter",function(e){var t=$(this);s=setTimeout(function(){m(),t.parents(".reactions-wrap").find(".reactions-detail").css("display","flex").addClass("active")},750)}),c.unbind("mouseleave"),c.on("mouseleave",function(e){$(this);clearTimeout(s),r||m()}),VNE.Comment.init_Reactions_Event||($(document).on("click",function(e){e.target.closest(".reactions-detail")||e.target.closest(".reactions-total")||m(),!root.find(".user_comment .info.open").length||e.target.closest(".user_comment .hint")||e.target.closest(".user_comment .info.open")||root.find(".user_comment .info.open").removeClass("open")}),$(document).on("scroll",m),VNE.Comment.init_Reactions_Event=!0)},isInViewport=function(e){const t=window.scrollY||window.pageYOffset,n=e.getBoundingClientRect().top+t,o=t,i=t+window.innerHeight,a=n,s=n+e.clientHeight;return s>=o&&s<=i||a<=i&&a>=o},Emoticons={smilesPath:"",smiles:{":-)":"emoji-1",":-D":"emoji-2",xD:"emoji-3",":')":"emoji-4",":P":"emoji-5",";)":"emoji-6","^^":"emoji-7","^_^":"emoji-8","<3":"emoji-9",":^*":"emoji-10","B)":"emoji-11",":|":"emoji-12",":o":"emoji-13",":(":"emoji-14",":'(":"emoji-15",":-/":"emoji-16",":@":"emoji-17",":VN:":"emoji-18"},smilesVariations:{":)":"emoji-1",":-P":"emoji-5",";-)":"emoji-6","&lt;3":"emoji-9","B-)":"emoji-11",":-|":"emoji-12",":-o":"emoji-13",":vn:":"emoji-18"},smileBoxBtn:"#smileBoxBtn",getRegExp:function(){var ret="/";return $.each(Emoticons.smilesVariations,function(e){var t=e.replace(/\)/g,"\\)").replace(/\(/g,"\\(").replace(/\|/g,"\\|").replace(/\*/g,"\\*").replace(/\^/g,"\\^").replace(/\//g,"\\/");ret+="("+t+")|"}),ret+="/g",eval(ret)},addSmilesBox:function(){var e="";e+='<svg class="icon icon_emoji emoji-icon"><use xlink:href="'+Emoticons.smilesPath+'#emoji-icon"></use></svg>',e+='<div class="list_emoji">',e+='<ul class="ul_emoji">',$.each(Emoticons.smiles,function(t){e+='<li class="item_emoji" data-emj="'+t+'">'+Emoticons.convertEmoji(t)+"</li>"}),e+="</ul>",e+="</div>",root.find(".box_emoji").html(e),Emoticons.initEventEmoji()},initEventEmoji:function(){root.find(".box_emoji .emoji-icon").click(function(e){e.stopPropagation(),$(this).parent().toggleClass("show_list_emoji")}),root.find(".ul_emoji .item_emoji").click(function(e){e.stopPropagation(),useReply="comment_reply_form"===$(this).parents("form").attr("id")?1:0,$(this).parents(".box_emoji").removeClass("show_list_emoji");var t=$(this).attr("data-emj"),n=$(this).parents(".input_comment").find("textarea:visible");n.focus(),_insertCharacter(n," "+t+" "),validate_Emoji(n)}),root.find(".box_emoji").show()},convertEmoji:function(e){return function(e){var t=Emoticons.getRegExp();return e.replace(t,function(e){var t=Emoticons.smilesVariations[e];return t?t='<svg class="icon icon_emoji '+t+'"><use xlink:href="'+Emoticons.smilesPath+"#"+t+'"></use></svg>':""})}(e)},parseEmoji:function(){var e=$(".txt_comment").clone();return e.find("img").each(function(){var e="("+$(this).attr("alt")+")";$(this).replaceWith(e)}),e.html()},checkHadEmoji:function(e){var t=!1;return $.each(Emoticons.smilesVariations,function(n){var o=n.replace(/\)/g,"\\)").replace(/\(/g,"\\(").replace(/\|/g,"\\|").replace(/\*/g,"\\*").replace(/\^/g,"\\^").replace(/\//g,"\\/");new RegExp(o,"gi").test(e)&&(t=!0)}),t}},_insertCharacter=function(e,t){var n=e.get(0).selectionStart,o=e.val();e.val(o.substring(0,n)+t+o.substring(n))};$.extend(Emoticons.smilesVariations,Emoticons.smiles);var text_diff=function(e,t){for(var n=0;n<e.length&&e[n]==t[n];)++n;for(var o=0;e.length-o>n&&e[e.length-o-1]==t[t.length-o-1];)++o;return o=t.length-o,t.substr(n,o-n)},checkUrl=function(e){return!!/^([a-z]([a-z]|\d|\+|-|\.)*):(\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?((\[(|(v[\da-f]{1,}\.(([a-z]|\d|-|\.|_|~)|[!\$&'\(\)\*\+,;=]|:)+))\])|((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=])*)(:\d*)?)(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*|(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)|((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)|((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)){0})(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)},nl2br=(e,t)=>null==e?"":(e+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+(t||void 0===t?"<br />":"<br>")+"$2"),checkHadDomainLink=function(e){var t,n=!1,o=/(https?:\/\/)?(?:\S+[a-zA-Z0-9](?::\S*)?@)?[\w-]+(\.[a-z-]+)+\.?(:\d+)?(?:[\/?#]\S*)?/gm;if(void 0===myvne_users.profile.user_id)o.test(e)&&(n=!0);else for(;null!==(t=o.exec(e));){t.index===o.lastIndex&&o.lastIndex++;var i=t[0].replace(/http[s]*?:\/\//,""),a=(i=i.split("?")[0]).split("/")[0].toLowerCase();if(a.search(/vnexpress\.net|ngoisao\.vnexpress\.net|ione\.vnexpress\.net/)<0&&a.search(/\.net|\.com|\.vn|\.com.vn|\.info|\.org/)>-1){n=!0;break}}return n},parseUrltoBcode=function(e){var t,n=/((?:(http|https|Http|Https|rtsp|Rtsp):\/\/(?:(?:[a-zA-Z0-9\$\-\_\.\+\!\*\'\(\)\,\;\?\&\=]|(?:\%[a-fA-F0-9]{2})){1,64}(?:\:(?:[a-zA-Z0-9\$\-\_\.\+\!\*\'\(\)\,\;\?\&\=]|(?:\%[a-fA-F0-9]{2})){1,25})?\@)?)?((?:(?:[a-zA-Z0-9][a-zA-Z0-9\-]{0,64}\.)+(?:(?:aero|arpa|asia|a[cdefgilmnoqrstuwxz])|(?:biz|b[abdefghijmnorstvwyz])|(?:cat|com|coop|c[acdfghiklmnoruvxyz])|d[ejkmoz]|(?:edu|e[cegrstu])|f[ijkmor]|(?:gov|g[abdefghilmnpqrstuwy])|h[kmnrtu]|(?:info|int|i[delmnoqrst])|(?:jobs|j[emop])|k[eghimnrwyz]|l[abcikrstuvy]|(?:mil|mobi|museum|m[acdghklmnopqrstuvwxyz])|(?:name|net|n[acefgilopruz])|(?:org|om)|(?:pro|p[aefghklmnrstwy])|qa|r[eouw]|s[abcdeghijklmnortuvyz]|(?:tel|travel|t[cdfghjklmnoprtvwz])|u[agkmsyz]|v[aceginu]|w[fs]|y[etu]|z[amw]))|(?:(?:25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[1-9])\.(?:25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[1-9]|0)\.(?:25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[1-9]|0)\.(?:25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[1-9][0-9]|[0-9])))(?:\:\d{1,5})?)(\/(?:(?:[a-zA-Z0-9\;\/\?\:\@\&\=\#\~\-\.\+\!\*\'\(\)\,\_])|(?:\%[a-fA-F0-9]{2}))*)?(?:\b|$)/gm,o=e;for(o=o.replace(/\<br\/\>|\&nbsp\;/g," ");null!==(t=n.exec(o));){t.index===n.lastIndex&&n.lastIndex++;var i=t[0].toLowerCase();-1!=i.indexOf("ione.vnexpress.net")&&(i=i.replace(/ione\.vnexpress\.net/g,"ione.net")),e=e.replace(t[0],parseUrltoBcode_item(i))}return e},parseUrltoBcode_item=function(e){for(var t,n=/^(?:http[s]*?\:\/\/)?(\w*?[\.|\-\]*?\w*?\.[a-zA-Z]*?)(?:$|\:.*?|\/.*?-(\d+?)(?:[-tong-thuat]*?|\/index).html)(.*)/gm,o=e.replace(/\<br\/\>|\&nbsp\;/g," "),i=!1;null!==(t=n.exec(o));)t.index===n.lastIndex&&n.lastIndex++,void 0!==t[1]&&t[1].search(/vnexpress\.net|ngoisao\.vnexpress\.net|ione\.vnexpress\.net|ngoisao\.net|ione\.net/)>-1&&void 0!==t[2]&&parseInt(t[2])>0&&(e=parseInt(t[2])>793193?e.replace(t[0],'<span component-embed-link="'+t[0].replace(/\./g,"::")+'" component-embed-link-id="'+t[2]+'" class="component-embed-link component-embed-link-id"></span>'):e.replace(t[0],'<span component-embed-link-id="0" component-embed-link="'+t[0].replace(/\./g,"::")+'" class="component-embed-link"></span>'),i=!0);if(!i){var a=e,s=a.replace(/http[s]*?:\/\//,""),r=s.split("/")[0].toLowerCase();if(r.search(/vnexpress\.net|ngoisao\.vnexpress\.net|ione\.vnexpress\.net|ngoisao\.net|ione\.net/)>-1){var c=s.split("?")[0].split("-").pop();e=parseInt(c)>793193?e.replace(a,'<span component-embed-link="'+a.replace(/\./g,"::")+'" component-embed-link-id="'+c+'" class="component-embed-link component-embed-link-id"></span>'):e.replace(a,'<span component-embed-link-id="0" component-embed-link="'+a.replace(/\./g,"::")+'" class="component-embed-link"></span>')}else r.search(/\.net|\.com|\.vn|\.com.vn|\.info|\.org/)>-1&&(e=e.replace(a,""))}return o=null,e},convertEmbedUrl=function(e){return function(e){return e.replace(/<embed-link>(\d+)<\/embed-link>/gm,function(e){var t=e.match(/\d+/g);return'<div component-embed-link="'+(t=t[0])+'" class="component-embed-link"></div>'})}(e)},parseEmbedLink=function(){var e=[];root.find(".comment_item .component-embed-link-id").each(function(t){var n=$(this).attr("component-embed-link-id");e.push(n)}),e.length&&$.getJSON("https://gw.vnexpress.net/ar/get_basic",{data_select:"article_id,share_url,thumbnail_url,title,publish_time",article_id:e.join(","),thumb_size:"120x72",thumb_quality:100,thumb_dpr:2,thumb_fit:"crop"},function(e){if(200==e.code&&e.data.length){var t={};$.each(e.data,function(e,n){t[n.article_id]=n}),displayEmbedLink(t,!0)}}),!e.length&&root.find(".comment_item .component-embed-link").length&&displayEmbedLink({})},displayEmbedLink=function(e,t=!1){function n(e,t,n){var o=new Date(1e3*e.publish_time),i=["Chủ nhật","Thứ hai","Thứ ba","Thứ tư","Thứ năm","Thứ sáu","Thứ bảy"][o.getDay()]+", "+("0"+o.getDate()).slice(-2)+"/"+("0"+(o.getMonth()+1)).slice(-2)+"/"+o.getFullYear()+" "+("0"+o.getHours()).slice(-2)+":"+("0"+o.getMinutes()).slice(-2)+" (GMT+7)",a="",s=""!=n?n:e.share_url,r="VnExpress";(e.share_url.search(/ngoisao\.vnexpress\.net/)>-1||e.share_url.search(/ngoisao\.net/)>-1)&&(r="ngoisao.vnexpress.net"),(e.share_url.search(/ione\.vnexpress\.net/)>-1||e.share_url.search(/ione\.net/)>-1)&&(r="ione.vnexpress.net"),e.thumb_list&&e.thumb_list.thumb_120_72_100_2_crop&&(e.thumbnail_url=e.thumb_list.thumb_120_72_100_2_crop);var c="";e.thumbnail_url&&(c='<img src="'+e.thumbnail_url+'" alt="'+e.title+'">',e.thumbnail_url.indexOf(".gif")>-1&&e.thumbnail_url.indexOf("t=video")>-1&&(c=`\n                        <video style="width: 100%;object-fit: cover;height: auto" autoplay="" loop="" muted="" playsinline="" preload="auto" src="${e.thumbnail_url}"><source type="video/mp4" src="${e.thumbnail_url}"></video>\n                    `)),a+='<div class="width_common box_news_on_comment flexbox">',c&&(a+='<div class="thumb_on_com">',a+='<a href="'+s+'" class="img_thumb_com img_5x3">'+c+"</a>",a+="</div>"),a+='<div class="info_news_on_com">',a+='<h3 class="title_on_com"><a href="'+s+'" class="title_news_com">'+e.title+'<span class="name_site"> - '+r+"</span></a></h3>",a+='<p class="lead_on_com">'+i+"</p>",a+="</div>",a+="</div>",t.parent().parent().find("> .block_like_web").before(a)}root.find(".comment_item .content-comment > p").each(function(o){$(this).find(".component-embed-link").each(function(o,i){var a=$(this).attr("component-embed-link-id"),s=$(this).attr("component-embed-link");if(0==parseInt(a)&&""!=s){var r='<a class="link_text_com" href="'+("https://"+(s=s.replace(/\:\:/g,".")).replace(/http[s]*?:\/\//,""))+'">'+s+"</a>";$(this).replaceWith(r)}if(t&&parseInt(a)>0)if(void 0!==e[a]){s=s.replace(/\:\:/g,".");var c=e[a];$(this).parent().parent().find("> .box_news_on_comment").length<=0&&n(c,$(this),s);r='<a class="link_text_com" href="'+s+'">'+c.title+"</a>";$(this).replaceWith(r)}else{r='<a href="javascript:;" class="link_text_com link_hide" data-hide="'+a+'">«liên kết đã ẩn»</a>';$(this).replaceWith(r)}})}),root.find(".sub_comment_item > p").each(function(o){$(this).find(".component-embed-link").each(function(o,i){var a=$(this).attr("component-embed-link-id"),s=$(this).attr("component-embed-link");if(0==parseInt(a)&&""!=s){var r='<a class="link_text_com" href="'+("https://"+(s=s.replace(/\:\:/g,".")).replace(/http[s]*?:\/\//,""))+'">'+s+"</a>";$(this).replaceWith(r)}if(t&&parseInt(a)>0)if(void 0!==e[a]){s=s.replace(/\:\:/g,".");var c=e[a];$(this).parent().parent().find("> .box_news_on_comment").length<=0&&n(c,$(this),s);r='<a class="link_text_com" href="'+s+'">'+c.title+"</a>";$(this).replaceWith(r)}else{r='<a href="javascript:;" class="link_text_com link_hide" data-hide="'+a+'">«liên kết đã ẩn»</a>';$(this).replaceWith(r)}})})};const getFolderSetOn=e=>{let t="";try{t=dataLayer.find(e=>e.hasOwnProperty("pageSubcategory"))?.pageSubcategory,!t&&$('meta[itemprop="articleSection"]')[0]&&(t=$('meta[itemprop="articleSection"]').attr("content"))}catch(e){t=""}return t};let nonAccentVietnamese=e=>{if(void 0!==e&&e)return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.toLowerCase()).replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g,"a")).replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e")).replace(/ì|í|ị|ỉ|ĩ|î/g,"i")).replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ|ø|ö/g,"o")).replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ|ü/g,"u")).replace(/ỳ|ý|ỵ|ỷ|ỹ/g,"y")).replace(/đ/g,"d")).replace(/š|ş/g,"s")).replace(/ć|č|ç/g,"c")).replace(/ñ/g,"n")).replace(/\u0300|\u0301|\u0303|\u0309|\u0323/g,"")).replace(/\u02C6|\u0306|\u031B/g,"")};const formatUtmSourceText=e=>{if(!e)return"";let t=nonAccentVietnamese(e).replace(/[-_.&?^#"]/g," ").trim().toLowerCase(),n=t.split(" ");for(let e in n)n[e]=n[e].replace(/^./,e=>e.toUpperCase());return t=n.join(""),t},smoothScroll=(e,t,n,o)=>{const i=document.querySelector(e).getBoundingClientRect().top+window.pageYOffset,a=window.pageYOffset,s=i-a+n;let r=null;requestAnimationFrame(function e(n){null===r&&(r=n);const i=n-r,c=(m=i,l=a,d=s,(m/=t/2)<1?d/2*m*m+l:(m--,-d/2*(m*(m-2)-1)+l));var m,l,d;device_env>1&&location.hostname.indexOf("video.vnexpress.net")>-1&&document.querySelector("#scroll_pane_right .inner_detail_right")?document.querySelector("#scroll_pane_right .inner_detail_right").scrollTo(0,c):window.scrollTo(0,c),i<t?requestAnimationFrame(e):"function"==typeof o&&o()})};let trackingADP=(e={})=>{try{let e={campaign_name:"",engagement_type:1002,index_brand:"form",index_industrial:"",index_category:"",index_topic:""};const t=document.querySelector("body").getAttribute("data-source");if(t&&t.indexOf("Detail-SucKhoe_CacBenh")>-1&&"undefined"!=typeof dataLayer){let t=dataLayer.filter(e=>e.pageCategoryName_LP);t&&t[0]&&(t=t[0].pageCategoryName_LP,e.campaign_name="benh"+nonAccentVietnamese(t.toLowerCase().replace(/\s+/g,""))+"_guicomment_detail")}if(!e.campaign_name)return;(window._logForm||(window._logForm=[])).push(e)}catch(e){console.log("push ADP error",e)}};"undefined"!=typeof Storage&&sessionStorage.mess_box_count&&(sessionStorage.mess_box_count=Number(sessionStorage.mess_box_count)+1),$(document).on("click",".message_box .close_mess",function(e){e.preventDefault(),"undefined"!=typeof Storage&&(sessionStorage.mess_box_count=6)});const setDetailComment=e=>{if(e&&e.data&&e.data.items&&e.data.items.length){for(const t of e.data.items){const e=t.comment_id;_objComments[e]=t;let n=getStorage_React(e),o=+t.like_ismember;if(n){let i=+n.data.slice(-1)[0];if(o!=i&&1==n.last_status){let o=n.last_inc;o.total_like&&(t.userlike+=o.total_like),$.each(o,function(e,n){void 0!==t[e]&&(t[e]+=n)}),1==n.last_status&&i?t.like_ismember=i:t.like_ismember=!1,_objComments[e]=t}}}return e}},addComment_Extends=(e,t=0,n=0,o)=>{if("function"!=typeof o)return void console.log("addCommentExtends: callback is not a function");if("undefined"==typeof myvne_users||!myvne_users.profile||!myvne_users.profile.user_id)return void openPopupMyVnE();if(!(e=trim(e)))return void o("content is empty",null);var i=$.extend({},options);i.content=e;const a="undefined"!=typeof myvne_users&&"object"==typeof myvne_users.profile?myvne_users.profile:{};i.userid=a.user_id,i.usertype=a.user_login_type,i.fullname=a.user_fullname,i.email=a.user_email,i.fullname||(i.fullname=i.email.replace(/@.*/,"")),i.parentid=t?parseInt(t):0,i.frommobile=1==device_env?1:0,n&&(i.reply_to=parseInt(n)),getAuthentication(function(e){i.t=e.t,i._csrf=e._t;var n=String(i.content)+String(i.objectid)+String(i.objecttype)+String(i.t)+String(i._csrf);i._sign=md5(n),$.ajax({url:server_url+"/index/add/v2",type:"POST",dataType:"json",data:i,xhrFields:{withCredentials:!0},success:function(e){try{(egg=window._logEgg||[]).push({action:"comment"})}catch(e){}try{parseInt(t)>0?dataLayer.push({event:"commentEvent",method:"",comment_action:"Reply comment",user_id:i.userid}):dataLayer.push({event:"commentEvent",method:"",comment_action:"Submit comment",user_id:i.userid}),trackingADP(i)}catch(e){}o(null,e)},timeout:5e3,error:function(e,t,n){console.log("add comment error",e,t,n),o(t,null)}})})},likeComment_Extends=(e={},t)=>{if("function"!=typeof t)return void console.log("addCommentExtends: callback is not a function");if(!e.react_name||!["like"].includes(e.react_name))return void t("react_name is invalid",null);if(!e.comment_id)return void t("comment_id is Empty",null);var n={},o=e.react_name,i=getLikeTypeByName(o),a=+e.comment_id,s=getInfoUserReact(a,i);if(-1==s.status)return void t("Bạn đã sử dụng chức năng này. Bạn phải đợi 24h nữa mới được thao tác tiếp",null);setStorage_React(a,i);var r=_objComments[a];if(n.site_id=options.siteid,n.comment_id=a,n.react_type=i,n.status=s.status,n.object_id=+options.objectid,n.object_type=+options.objecttype,n.url=document.location.href,n._cmt_token="","object"==typeof myvne_users&&"object"==typeof myvne_users.profile){var c=myvne_users.profile;c.user_id&&(n.userid=c.user_id,n.token_key=c.user_session)}const m=processOnOffReactions(r);1==n.status&&i?m.like_ismember=i:m.like_ismember=!1,t(null,m);try{(egg=window._logEgg||[]).push({action:"like"})}catch(e){}try{dataLayer.push({event:"commentEvent",method:"",comment_action:"Like comment"})}catch(e){}try{"undefined"!=typeof vneNotify&&"undefined"!=vneNotify.setLiveComment&&vneNotify.setLiveComment()}catch(e){console.log("webpush error",e)}return loadCaptchaV3(n.site_id,function(e){n._cmt_token=e,getAuthentication(function(e){n.t=e.t,n._csrf=e._t;var t=String(n.react_type)+String(n.comment_id)+String(n.status)+String(n.object_id)+String(n.object_type)+String(n.t)+String(n._csrf);n.sign=md5(t),$.ajax({url:server_url+"/post/cmt/like",type:"POST",dataType:"json",data:n,xhrFields:{withCredentials:!0},success:function(e){},timeout:5e3,error:function(e,t,n){}})})}),!1},widgetCommentsArticle_Extends=()=>{const e=e=>{setOption({objectid:e.objectid,objecttype:e.objecttype,siteid:e.siteid,categoryid:e.categoryid,sign:e.sign,limit:e.limit,share_url:e.share_url?e.share_url:null});const n=$(`[data-component-widget-article="${e.objectid}"]`),o=n.find("#list_comment");let i=Object.assign({},options);$.ajax({data:i,url:server_url+"/index/get",dataType:"json",success:function(a,s,r){if(n.find(".box_comment_vne").show(),!a.error&&a.data.totalitem){var c="";$.each(a.data.items,function(e,t){c+=getCommentItem(e,t)}),o.append(c),o.show(),addListenerForCommentDetail(o),parseUserMyVNE(),parseEmbedLink(),updateState_Reactions(a.data.items,r),t(o),o.find(".comment_item .content_less").addClass("full_content"),o.find(".comment_item .full_content").css("cursor","pointer"),o.find(".comment_item .count-reply").css("display","none"),o.find(".view_more_coment").remove();let n=o.find("> .comment_item").length;if(a.data.total>n){const t=parseInt(a.data.totalitem)-parseInt(i.limit);let n=t?`Xem ${t} ý kiến khác`:"Xem thêm ý kiến khác";root.find(".box_comment_vne").append(`<div class="view_more_coment width_common mb10"><a href="${e.share_url?`${e.share_url}#box_comment_vne`:"javascript:;"}" class="txt_666" title="${n}">${n}</a></div>`)}}},timeout:3e4,error:function(e,t,n){}})},t=e=>{e.find(".comment_item .content-comment").on("click","> p:first",function(e){e.preventDefault();const t=+$(this).closest(".comment_item").find(".link_thich").attr("rel");if(t&&options.share_url)return location.href=`${options.share_url}?commentid=${t}`,!1})};return(()=>{const t=$("[data-component-widget-article]").length;$("[data-component-widget-article][data-component-input]").each((n,o)=>{let i=$(o).attr("data-component-input");$(o).removeAttr("data-component-input"),i&&(i=$.parseJSON(i),1==t?e(i):$(o).html(`\n                            <div class="input_comment width_common">\n                                <a class="link-detail width_common" href="${i.share_url?`${i.share_url}#box_comment_vne`:"javascript:;"}">\n                                    <div class="box-area-input width_common">\n                                        <textarea placeholder="Chia sẻ ý kiến của bạn" class="block_input"></textarea>\n                                    </div>\n                                    <div class="box_emoji">\n                                        <svg class="icon icon_emoji emoji-icon"><use xlink:href="#emoji-icon"></use></svg>\n                                    </div>\n                                </a>\n                            </div>\n                        `).addClass("box_comment_vne"))})})()};if(VNE.Comment.setOptions=setOption,VNE.Comment.getComments=getComments,VNE.Comment.sortBy=sortedBy,VNE.Comment.setAnonymous=setAnonymous,VNE.Comment.unSetAnonymous=unSetAnonymous,VNE.Comment.getCommentItem=getCommentItem,VNE.Comment.addListenerForCommentDetail=addListenerForCommentDetail,VNE.Comment.showBlockShare=showBlockShare,VNE.Comment.showReportBadForm=showReportBadForm,VNE.Comment.addReportBad=addReportBad,VNE.Comment.parseUserMyVNE=parseUserMyVNE,window.displayUserMyVnE=displayUserMyVNE,VNE.Comment.openPopupMyVnE=openPopupMyVnE,VNE.Comment.showAlertBox=showAlertBox,VNE.Comment.setDetailComments=setDetailComment,VNE.Comment.addCommentExtends=addComment_Extends,VNE.Comment.likeCommentExtends=likeComment_Extends,VNE.Comment.widgetCommentsArticleExtends=widgetCommentsArticle_Extends,$("#box_comment_vne").length)if($("#box_comment_vne").parent().hasClass("both-content"));else{var config=$("#box_comment_vne").attr("data-component-input");void 0!==config&&""!=config&&(config=$.parseJSON(config),VNE.Comment.setOptions({objectid:config.article_id,objecttype:config.article_type,siteid:config.site_id,categoryid:config.category_id,sign:config.sign,default_number_comment:config.default_number_comment,limit:25,tab_active:config.tab_active?config.tab_active:"most_like",reactions:config.reactions?config.reactions:""}),VNE.Comment.getComments())}try{CmtWidget.importScript("https://la2.vnecdn.net/static/adp_banner.js")}catch(e){}})(window,document);